<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Functional Idioms in C++</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="func-idioms-c++.tex"> 
<meta name="date" content="2013-09-16 21:46:00"> 
<link rel="stylesheet" type="text/css" href="func-idioms-c++.css"> 
</head><body 
>
<div class="maketitle">
                                                                          

                                                                          
                                                                          

                                                                          

<h2 class="titleHead">Functional Idioms in C++</h2>
<div class="author" ><span 
class="cmss-12x-x-120">Alfons Haffmans</span></div><br />
<div class="date" ><span 
class="cmss-12x-x-120">September 16, 2013</span></div>
</div><div 
class="abstract" 
>
<div class="center" 
>
<!--l. 76--><p class="noindent" >
<!--l. 76--><p class="noindent" ><span 
class="cmssbx-10x-x-109">Abstract</span></div>
      <!--l. 77--><p class="indent" >    <span 
class="cmss-10x-x-109">In  this  paper  I  review  the  implementation  of  functors,  applicative</span>
      <span 
class="cmss-10x-x-109">functors and monads in C++.</span>
</div>
<h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
<div class="tableofcontents">
<span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Introduction</a></span>
<br />&#x00A0;<span class="subsectionToc" >1.1 <a 
href="#x1-30001.1" id="QQ2-1-3">Functional Programming</a></span>
<br />&#x00A0;<span class="subsectionToc" >1.2 <a 
href="#x1-40001.2" id="QQ2-1-4">Support in C++</a></span>
<br />&#x00A0;<span class="subsectionToc" >1.3 <a 
href="#x1-50001.3" id="QQ2-1-5">Conventions and Notation</a></span>
<br /><span class="sectionToc" >2 <a 
href="#x1-60002" id="QQ2-1-6">Functional Idioms</a></span>
<br />&#x00A0;<span class="subsectionToc" >2.1 <a 
href="#x1-70002.1" id="QQ2-1-7">Introduction</a></span>
                                                                          

                                                                          
<br />&#x00A0;<span class="subsectionToc" >2.2 <a 
href="#x1-80002.2" id="QQ2-1-8">Currying</a></span>
<br />&#x00A0;<span class="subsectionToc" >2.3 <a 
href="#x1-90002.3" id="QQ2-1-10">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >2.4 <a 
href="#x1-100002.4" id="QQ2-1-11">Applicative Functors and Brackets</a></span>
<br />&#x00A0;&#x00A0;<span class="subsubsectionToc" >2.4.1 <a 
href="#x1-110002.4.1" id="QQ2-1-12">Applicatives</a></span>
<br />&#x00A0;&#x00A0;<span class="subsubsectionToc" >2.4.2 <a 
href="#x1-120002.4.2" id="QQ2-1-13">Brackets</a></span>
<br />&#x00A0;<span class="subsectionToc" >2.5 <a 
href="#x1-130002.5" id="QQ2-1-14">Monads</a></span>
<br /><span class="sectionToc" >3 <a 
href="#x1-140003" id="QQ2-1-15">The Functional Idioms in C++</a></span>
<br />&#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-150003.1" id="QQ2-1-16">General Approach</a></span>
<br />&#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-160003.2" id="QQ2-1-17">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >3.3 <a 
href="#x1-170003.3" id="QQ2-1-19">Applicative Functor and Brackets</a></span>
<br />&#x00A0;&#x00A0;<span class="subsubsectionToc" >3.3.1 <a 
href="#x1-180003.3.1" id="QQ2-1-20">Applicative</a></span>
<br />&#x00A0;&#x00A0;<span class="subsubsectionToc" >3.3.2 <a 
href="#x1-190003.3.2" id="QQ2-1-22">Bracket</a></span>
<br />&#x00A0;<span class="subsectionToc" >3.4 <a 
href="#x1-200003.4" id="QQ2-1-24">Monad</a></span>
<br /><span class="sectionToc" >4 <a 
href="#x1-210004" id="QQ2-1-26">Maybe</a></span>
<br />&#x00A0;<span class="subsectionToc" >4.1 <a 
href="#x1-220004.1" id="QQ2-1-27">Motivation</a></span>
<br />&#x00A0;<span class="subsectionToc" >4.2 <a 
href="#x1-230004.2" id="QQ2-1-28">Maybe Template Class</a></span>
<br />&#x00A0;<span class="subsectionToc" >4.3 <a 
href="#x1-240004.3" id="QQ2-1-32">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >4.4 <a 
href="#x1-250004.4" id="QQ2-1-35">Applicative Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >4.5 <a 
href="#x1-260004.5" id="QQ2-1-38">Monad</a></span>
<br /><span class="sectionToc" >5 <a 
href="#x1-270005" id="QQ2-1-41">Either</a></span>
<br />&#x00A0;<span class="subsectionToc" >5.1 <a 
href="#x1-280005.1" id="QQ2-1-42">Motivation</a></span>
<br />&#x00A0;<span class="subsectionToc" >5.2 <a 
href="#x1-290005.2" id="QQ2-1-43">Either Type Class</a></span>
<br />&#x00A0;<span class="subsectionToc" >5.3 <a 
href="#x1-300005.3" id="QQ2-1-47">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >5.4 <a 
href="#x1-310005.4" id="QQ2-1-50">Applicative Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >5.5 <a 
href="#x1-320005.5" id="QQ2-1-53">Monad</a></span>
<br /><span class="sectionToc" >6 <a 
href="#x1-330006" id="QQ2-1-56">Lists and ZipLists</a></span>
<br />&#x00A0;<span class="subsectionToc" >6.1 <a 
href="#x1-340006.1" id="QQ2-1-57">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >6.2 <a 
href="#x1-350006.2" id="QQ2-1-58">Applicative Functor</a></span>
<br />&#x00A0;&#x00A0;<span class="subsubsectionToc" >6.2.1 <a 
href="#x1-360006.2.1" id="QQ2-1-59">List</a></span>
<br />&#x00A0;&#x00A0;<span class="subsubsectionToc" >6.2.2 <a 
href="#x1-370006.2.2" id="QQ2-1-61">ZipList</a></span>
<br />&#x00A0;<span class="subsectionToc" >6.3 <a 
href="#x1-380006.3" id="QQ2-1-64">Brackets</a></span>
<br />&#x00A0;<span class="subsectionToc" >6.4 <a 
href="#x1-390006.4" id="QQ2-1-67">Monad</a></span>
<br /><span class="sectionToc" >7 <a 
href="#x1-400007" id="QQ2-1-69">Shared Pointers</a></span>
<br />&#x00A0;<span class="subsectionToc" >7.1 <a 
href="#x1-410007.1" id="QQ2-1-70">Shared pointers</a></span>
<br />&#x00A0;<span class="subsectionToc" >7.2 <a 
href="#x1-420007.2" id="QQ2-1-72">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >7.3 <a 
href="#x1-430007.3" id="QQ2-1-73">Applicative Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >7.4 <a 
href="#x1-440007.4" id="QQ2-1-74">Monad</a></span>
<br /><span class="sectionToc" >8 <a 
href="#x1-450008" id="QQ2-1-76">List of Shared Pointers</a></span>
                                                                          

                                                                          
<br />&#x00A0;<span class="subsectionToc" >8.1 <a 
href="#x1-460008.1" id="QQ2-1-77">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >8.2 <a 
href="#x1-470008.2" id="QQ2-1-79">Applicative Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >8.3 <a 
href="#x1-480008.3" id="QQ2-1-83">Monad</a></span>
<br /><span class="sectionToc" >9 <a 
href="#x1-490009" id="QQ2-1-84">Unary Operations</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.1 <a 
href="#x1-500009.1" id="QQ2-1-85">Unary Operations and Curried Functions</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.2 <a 
href="#x1-510009.2" id="QQ2-1-86">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.3 <a 
href="#x1-520009.3" id="QQ2-1-89">Applicative Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.4 <a 
href="#x1-530009.4" id="QQ2-1-90">Monad</a></span>
<br /><span class="sectionToc" >10 <a 
href="#x1-5400010" id="QQ2-1-91">Stateful Computations</a></span>
<br />&#x00A0;<span class="subsectionToc" >10.1 <a 
href="#x1-5500010.1" id="QQ2-1-92">Capturing State</a></span>
<br />&#x00A0;<span class="subsectionToc" >10.2 <a 
href="#x1-5600010.2" id="QQ2-1-98">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >10.3 <a 
href="#x1-5700010.3" id="QQ2-1-101">Applicative Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >10.4 <a 
href="#x1-5800010.4" id="QQ2-1-103">Monad</a></span>
<br /><span class="sectionToc" >11 <a 
href="#x1-5900011" id="QQ2-1-107">Futures and Future Values</a></span>
<br />&#x00A0;<span class="subsectionToc" >11.1 <a 
href="#x1-6000011.1" id="QQ2-1-108">Futures and Async</a></span>
<br />&#x00A0;<span class="subsectionToc" >11.2 <a 
href="#x1-6100011.2" id="QQ2-1-109">Capturing Future Values</a></span>
<br />&#x00A0;<span class="subsectionToc" >11.3 <a 
href="#x1-6200011.3" id="QQ2-1-112">Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >11.4 <a 
href="#x1-6300011.4" id="QQ2-1-113">Applicative Functor</a></span>
<br />&#x00A0;<span class="subsectionToc" >11.5 <a 
href="#x1-6400011.5" id="QQ2-1-114">Monad</a></span>
<br /><span class="sectionToc" >12 <a 
href="#x1-6500012" id="QQ2-1-115">Discussion</a></span>
</div>
<!--l. 84--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Introduction</h3>
<!--l. 87--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-30001.1"></a>Functional Programming</h4>
<!--l. 90--><p class="noindent" >Functional programming emphasizes the use of immutable data structures and pure
functions. A pure function&#8217;s output is determined solely by its input. However, this
does not capture all the complexity of realistic programs, like state, IO and
exceptions.
<!--l. 94--><p class="noindent" >In the late &#8217;80&#8217;s and early 90&#8217;s an approach was pioneered which incorporates impure
features, like exceptions, side-effects and IO into functional programming languages.
                                                                          

                                                                          
That approach relied heavily on concepts from category theory like functors and
monads. Clearly C++ already supports impure features so does it therefore make
sense to incorporate that framework into the language ? In this article I&#8217;ll attempt to
present an answer to that question.
<!--l. 101--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-40001.2"></a>Support in C++</h4>
<!--l. 104--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">1.3   </span> <a 
 id="x1-50001.3"></a>Conventions and Notation</h4>
<!--l. 108--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-60002"></a>Functional Idioms</h3>
<!--l. 113--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-70002.1"></a>Introduction</h4>
<!--l. 117--><p class="noindent" >To start off, let&#8217;s try to model failure in a functional setting. A fairly straightforward
approach is to have the function return a Boolean and a value as part of a pair. In
Haskell&#8217;s function notation the signature of that function is : <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++0x.png" alt="f :: a &#x2192; [bool , b]
" class="math-display" ></center>
</div>The function <span 
class="cmmi-12">f </span>takes a value of type <span 
class="cmmi-12">a </span>an returns a pair of a Boolean and a
value of type <span 
class="cmmi-12">b</span>. If the Boolean is true, an exception has occurred, and the
other member of the pair is ignored. If it&#8217;s false, the second slot contains
the result of the computation. We can generalize this to a type class <span 
class="cmmi-12">M</span>:
<div class="eqnarray">
                                                                          

                                                                          
<center class="math-display" >
<img 
src="func-idioms-c++1x.png" alt="f :: a &#x2192; M  b
" class="math-display" ></center>
</div><span 
class="cmmi-12">M </span>represents the &#8217;context&#8217; in which the computation occurs. Here are a few ways to
apply a function to a value in context <span 
class="cmmi-12">M</span>: <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++2x.png" alt="fmap   ::  (a &#x2192;  b) &#x2192;  M  a &#x2192; M  b

apply  ::  M  (a &#x2192;  b) &#x2192;  M  a &#x2192; M  b
 bind  ::  M  a &#x2192; (a &#x2192;  M  b) &#x2192; M  b
" class="math-display" ></center>
</div>These are all higher-order functions are higher order functions, which apply a function
to a value in a context.
<!--l. 139--><p class="noindent" ><span 
class="cmmi-12">fmap </span>takes a function <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">b </span>and applies to a value of type <span 
class="cmmi-12">a </span>in context <span 
class="cmmi-12">M</span>. The
result is a value of type <span 
class="cmmi-12">b </span>in the same context. <span 
class="cmmi-12">fmap </span>corresponds to mapping a
function over a container of values.
<!--l. 143--><p class="noindent" ><span 
class="cmmi-12">apply </span>uses a function <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">b </span>&#8217;lifted&#8217; into the context <span 
class="cmmi-12">M </span>and similarly applies it to a
value in the context. Note that <span 
class="cmmi-12">apply </span>requires <span 
class="cmmi-12">fmap </span>to be implemented. <span 
class="cmmi-12">apply </span>is part
of an applicative functor type class. It allows easier pipe-lining of functions working on
values in contexts.
<!--l. 148--><p class="noindent" >Lastly <span 
class="cmmi-12">bind </span>has a slightly different order in the type signature for historical reasons. It
takes a value in a context, and feeds that value into the function <span 
class="cmr-12">(</span><span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">M b</span><span 
class="cmr-12">)</span>. <span 
class="cmmi-12">bind</span>
implies the existence of <span 
class="cmmi-12">apply</span>. <span 
class="cmmi-12">bind </span>is part of the monad type class. Note that the
functions applied by <span 
class="cmmi-12">fmap </span>and <span 
class="cmmi-12">apply </span>are pure functions. <span 
class="cmmi-12">bind </span>takes a function which
returns a value in a context. It allows you to combine computations in the most
flexible way.
<!--l. 155--><p class="noindent" >In addition to the type interface each implementation needs to satisfy a number of
laws. The justification for these laws is not so obvious from the intuitive introduction
above, and can be found in abstract algebra and category theory.
                                                                          

                                                                          
<!--l. 161--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-80002.2"></a>Currying</h4>
<!--l. 166--><p class="noindent" ><span 
class="cmssi-12">Currying </span>turns any function into a higher order function of one variable <span class="cite">[<span 
class="cmssbx-10x-x-120">?</span>]</span>. The curry
of the function returns a partially applied version of the original.
<!--l. 169--><p class="noindent" >The operator <span 
class="cmmi-12">curry</span><span 
class="cmr-12">2 </span>is a higher order function which takes a binary function as input
and returns a unary higher order function. That function is the curry of the binary
function. <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++3x.png" alt="curry2  :: ((a,b) &#x2192;  c) &#x2192;    (a &#x2192;  b &#x2192;  c)

        f :: (a,b) &#x2192; c &#x21D2;    (curry2  f) :: a &#x2192; b &#x2192;  c
" class="math-display" ></center>
</div>When the curried version of <span 
class="cmmi-12">f </span>is called with an argument of type <span 
class="cmmi-12">a </span>it returns another
unary function Calling this function with an argument of type <span 
class="cmmi-12">b </span>returns the same value
as <span 
class="cmmi-12">f</span>. <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++4x.png" alt="plus : : (int x, int y) :: int = x + y &#x21D2;  cplus (int x) :: (int &#x2192; int)
                                        &#x2192;  (int y) :: int &#x2192;  x + y
                    plus(5,6) = 11  &#x21D4;   (curry2  plus )(5)(6 ) = 11
" class="math-display" ></center>
</div><span 
class="cmr-12">(</span><span 
class="cmmi-12">curry</span><span 
class="cmr-12">2</span><span 
class="cmmi-12">plus</span><span 
class="cmr-12">) </span>is the curried version of <span 
class="cmmi-12">plus</span>. <span 
class="cmssi-12">curry2 plus)(5) </span>returns a lambda which
represents the <span 
class="cmmi-12">plus </span>function partially applied to 5. When this partially applied version
of <span 
class="cmmi-12">plus </span>is called with 6 an unsurprising 11 is the result.
<!--l. 191--><p class="noindent" >Listing <a 
href="#x1-8003r1">1<!--tex4ht:ref: curry2 --></a> shows an implementation of curry2 in C++:
                                                                          

                                                                          
<div class="minipage"><!--l. 196-->
<a 
 id="x1-8003r1"></a>
<a 
 id="x1-8004"></a><div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-8005r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">U</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8006r2"></a></span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">U</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">curry</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">U</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">op</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8007r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8008r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[=]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[=]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">U</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">op</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8009r5"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8010r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">curry</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">([](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(5</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">+</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8011r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cout</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">(1)</span><span 
class="cmss-8x-x-75">(1)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">prints</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">6</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;1:
     </span><span  
class="content">curry
     for
     binary
     operators</span></div><!--tex4ht:label?: x1-8003r2 -->
</div></div>
<!--l. 213--><p class="noindent" >Currying plays an important role in functional programming <span class="cite">[<span 
class="cmssbx-10x-x-120">?</span>]</span>. It simplifies
the design of higher order functions because we only have to consider unary
functions.
<!--l. 216--><p class="noindent" >C++ does not provide a curry operator and functions are not written in curried form.
Compare this to Haskell where functions are curried by default <span class="cite">[<span 
class="cmssbx-10x-x-120">?</span>,&#x00A0;<span 
class="cmssbx-10x-x-120">?</span>]</span>. However writing
a curry operator or writing curried versions of a function has become a lot easier now
that lambda&#8217;s are supported.
<!--l. 225--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-90002.3"></a>Functor</h4>
<!--l. 232--><p class="noindent" >Let&#8217;s start with just a little bit of category theory.
<!--l. 234--><p class="noindent" >A category consists of objects and maps or arrows between the objects. The maps or
arrows are functions which take a value from the domain and to a value in the
co-domain. A simple example is the function <span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">n</span><span 
class="cmr-12">) = 2 </span><span 
class="cmsy-10x-x-120">* </span><span 
class="cmmi-12">n </span><span 
class="cmr-12">+ </span><span 
class="cmmi-12">y </span>where <span 
class="cmmi-12">n </span>is a integer.
Here domain and co-domain are the same.
<!--l. 238--><p class="noindent" >Maps can be combined to form other maps. This composition operation is denoted as
<span 
class="cmr-12">(</span><span 
class="cmmi-12">g </span><span 
class="cmsy-10x-x-120">&#x2218; </span><span 
class="cmmi-12">f</span><span 
class="cmr-12">)(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">) = </span><span 
class="cmmi-12">g</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)) </span>and is read as <span 
class="cmmi-12">g </span>after <span 
class="cmmi-12">f</span>. The objects A,B,C,.. and maps f,g,h..
form a category if they satisfy : <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++5x.png" alt="   f &#x2218; idA  =  idB &#x2218; f
(h &#x2218; g) &#x2218; f =  h &#x2218; (g &#x2218; f)
                                                                          

                                                                          
" class="math-display" ></center>
</div>
<!--l. 246--><p class="noindent" >Of particular interest are mappings between categories themselves.
<!--l. 248--><p class="noindent" >A very simple category is the monoid category <span 
class="bbm-12">1</span>. It consists of a single element <span 
class="cmmi-12">&#x22C6; </span>and
the identity <span 
class="cmmi-12">id</span>. It&#8217;s domain and co-domain are the same. We can construct maps
and label them as <span 
class="cmr-12">1</span><sub><span 
class="cmr-8">+</span></sub><span 
class="cmmi-12">, </span><span 
class="cmr-12">2</span><sub><span 
class="cmr-8">+</span></sub><span 
class="cmmi-12">,..n</span><sub><span 
class="cmr-8">+</span></sub><span 
class="cmmi-12">..</span>. The composite of two maps is defined as
<span 
class="cmmi-12">m</span><sub><span 
class="cmr-8">+</span></sub> <span 
class="cmsy-10x-x-120">&#x2218; </span><span 
class="cmmi-12">n</span><sub><span 
class="cmr-8">+</span></sub> <span 
class="cmr-12">= (</span><span 
class="cmmi-12">n </span><span 
class="cmr-12">+ </span><span 
class="cmmi-12">m</span><span 
class="cmr-12">)</span><sub><span 
class="cmr-8">+</span></sub> so that <span 
class="cmr-12">5</span><sub><span 
class="cmr-8">+</span></sub> <span 
class="cmsy-10x-x-120">&#x2218; </span><span 
class="cmr-12">3</span><sub><span 
class="cmr-8">+</span></sub> <span 
class="cmr-12">= 8</span><sub><span 
class="cmr-8">+</span></sub>.
<!--l. 254--><p class="noindent" >We can interpret this construction by letting <span 
class="cmmi-12">&#x22C6; </span>correspond to <span 
class="msbm-10x-x-120">&#x2124;</span>. Each map <span 
class="cmmi-12">n</span><sub><span 
class="cmr-8">+</span></sub> in the
monoid corresponds to a map <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">n</span></sub> such that <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">) = </span><span 
class="cmmi-12">n </span><span 
class="cmr-12">+ </span><span 
class="cmmi-12">x</span>, which is a curried <span 
class="cmr-12">+</span>
operator. It&#8217;s easy to see that this correspondence respects function composition :
<span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">m</span></sub> <span 
class="cmsy-10x-x-120">&#x2218; </span><span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmr-12">)(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">) = </span><span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">m</span></sub><span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)) = </span><span 
class="cmmi-12">m </span><span 
class="cmr-12">+ </span><span 
class="cmmi-12">n </span><span 
class="cmr-12">+ </span><span 
class="cmmi-12">x </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">n</span><span 
class="cmr-8">+</span><span 
class="cmmi-8">m</span></sub><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)</span>. and that <span 
class="cmmi-12">f</span><sub><span 
class="cmr-8">0</span></sub> is the identity
operator.
<!--l. 259--><p class="noindent" >Note that this interpretation of the monoid <span 
class="cmmi-12">&#x22C6; </span>is also a category. What we have just
defined is a mapping from one category (the monoid <span 
class="cmr-12">(</span><span 
class="cmmi-12">&#x22C6;,n</span><sub><span 
class="cmr-8">+</span></sub><span 
class="cmr-12">)</span>) to an other category :
<span 
class="cmr-12">(</span><span 
class="msbm-10x-x-120">&#x2124;</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">(</span><span 
class="cmmi-12">n</span><span 
class="cmr-12">+))</span>.
<!--l. 262--><p class="noindent" >A mapping between categories is called a functor. A functor <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /> </span>maps objects and
arrows or maps from one category to an other: <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++6x.png" alt="F (f : A &#x2192; B )  =  F (f) : F (A ) &#x2192; F (B )
       F (idA )  =  idF (A)
     F (g &#x2218; f)  =  F (g) &#x2218; F (f)
" class="math-display" ></center>
</div>
<!--l. 271--><p class="noindent" >We can create an alternative interpretation using lists of integers of size n :
<span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">n</span></sub> <span 
class="cmr-12">= (</span><span 
class="cmmi-12">a</span><sub><span 
class="cmr-8">1</span></sub><span 
class="cmmi-12">,...,a</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmr-12">)</span>. The identity element is the empty list <span 
class="cmmi-12">L</span><sub><span 
class="cmr-8">0</span></sub>. A natural operation on
lists is concatenation <span 
class="cmsy-10x-x-120">&#x2295; </span>which appends the elements of one list to the other. We
define the function <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">) = </span><span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">n</span></sub> <span 
class="cmsy-10x-x-120">&#x2295; </span><span 
class="cmr-12">[</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">]</span>
<!--l. 276--><p class="noindent" >The interpretation of the mappings <span 
class="cmr-12">1</span><sub><span 
class="cmmi-8">n</span></sub> is that of a curried concatenation to a list of
size n <span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">n</span></sub>. Function combination is easily verified <span 
class="cmr-12">(</span><span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">m</span></sub> <span 
class="cmsy-10x-x-120">&#x2218; </span><span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmr-12">)(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">) = </span><span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">m</span><span 
class="cmr-8">+</span><span 
class="cmmi-8">n</span></sub><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)</span>. This
interpretation satisfies the conditions of a functor between the monoid <span 
class="cmr-12">(</span><span 
class="cmmi-12">&#x22C6;,n</span><sub><span 
class="cmr-8">+</span></sub><span 
class="cmr-12">) </span>and the
monoid <span 
class="cmr-12">(</span><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-4c.png" alt="L" class="10-120x-x-4c" /></span><span 
class="cmmi-12">, </span><span 
class="cmr-12">(</span><span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmsy-10x-x-120">&#x2295;</span><span 
class="cmr-12">))</span>.
<!--l. 280--><p class="noindent" >We can now also define a functor between the category <span 
class="cmr-12">(</span><span 
class="msbm-10x-x-120">&#x2124;</span><span 
class="cmmi-12">,f</span><span 
class="cmr-12">) </span>and the category
                                                                          

                                                                          
<span 
class="cmr-12">(</span><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-4c.png" alt="L" class="10-120x-x-4c" /></span><span 
class="cmmi-12">, </span><span 
class="cmr-12">(</span><span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmsy-10x-x-120">&#x2295;</span><span 
class="cmr-12">)</span>. What that functor does is apply functions defined between elements of <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-5a.png" alt="Z" class="10-120x-x-5a" /></span>
to computations involving lists of integers. The functor preserves the structure of the
category of <span 
class="cmr-12">(</span><span 
class="msbm-10x-x-120">&#x2124;</span><span 
class="cmmi-12">,f</span><span 
class="cmr-12">)</span>.
<!--l. 284--><p class="noindent" >Can we construct a functor mapping between <span 
class="cmr-12">(</span><span 
class="msbm-10x-x-120">&#x2124;</span><span 
class="cmmi-12">,f</span><span 
class="cmr-12">) </span>and <span 
class="cmr-12">(</span><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-4c.png" alt="L" class="10-120x-x-4c" /></span><span 
class="cmmi-12">, </span><span 
class="cmr-12">(</span><span 
class="cmmi-12">L</span><sub><span 
class="cmmi-8">n</span></sub><span 
class="cmsy-10x-x-120">&#x2295;</span><span 
class="cmr-12">)) </span>?. The Functor
<span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /> </span>preserves the structure (what does that mean ??) of the category <span 
class="cmr-12">(</span><span 
class="msbm-10x-x-120">&#x2124;</span><span 
class="cmmi-12">,f</span><span 
class="cmr-12">) </span>if it
satisfies : <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++7x.png" alt="F &#x2218; f = F (f) &#x2218; F
" class="math-display" ></center>
</div>A reasonable choice of <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /> </span>is <span 
class="cmmi-12">x </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmr-12">[</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">] </span>i.e. we map each element of <span 
class="msbm-10x-x-120">&#x2124; </span>to a single
list. In that case we would have <span 
class="cmr-12">(</span><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" />&#x2218; </span><span 
class="cmmi-12">f</span><span 
class="cmr-12">)(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">) = </span><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span><span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)) = [</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)]</span>. So that
<span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span><span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">) : [</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">] </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmr-12">[</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)]</span>.
<!--l. 293--><p class="noindent" >In other words the functor would apply the mapping (or function) <span 
class="cmmi-12">f </span><span 
class="cmr-12">: </span><span 
class="msbm-10x-x-120">&#x2124; </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="msbm-10x-x-120">&#x2124; </span>to the
element in the list. It&#8217;s easy to see that this mapping <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /> </span>satisfies the requirement of a
functor : <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span><span 
class="cmr-12">(</span><span 
class="cmmi-12">id</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)) = [</span><span 
class="cmmi-12">id</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">)] = [</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">] = [] </span><span 
class="cmsy-10x-x-120">&#x2295; </span><span 
class="cmr-12">[</span><span 
class="cmmi-12">x</span><span 
class="cmr-12">]</span>.
<!--l. 297--><p class="noindent" >I&#8217;ve obviously ignored a lot of details. That said , it&#8217;s important to note that this
approach relies strictly on statements about function composition.
<!--l. 301--><p class="noindent" >Functors in functional programming generalize the concept of mapping a
function over values in a container of typeclass M. The typeclass in Haskell is :
<div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++8x.png" alt="class Functor   f  where
       fmap    ::  (a &#x2192; b) &#x2192;  f a &#x2192;  f b
" class="math-display" ></center>
</div>The <span 
class="cmmi-12">fmap </span>function generalizes the simple functor <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span>. <span 
class="cmmi-12">fmap </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">b </span>corresponds to
<span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span><span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">)</span>. In terms of <span 
class="cmmi-12">fmap </span>the functor requirements read <div class="eqnarray">
                                                                          

                                                                          
<center class="math-display" >
<img 
src="func-idioms-c++9x.png" alt="     fmap  id  =   id

fmap (g  &#x2218; f)  =   (fmap  g) &#x2218; (fmap f)
" class="math-display" ></center>
</div>Note that the <span 
class="cmmi-12">id </span>function on the left-hand side takes an value of type <span 
class="cmmi-12">a </span>whereas the
one on the right-hand side take a container of type <span 
class="cmmi-12">a</span>.
<!--l. 320--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-100002.4"></a>Applicative Functors and Brackets</h4>
<!--l. 326--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">2.4.1   </span> <a 
 id="x1-110002.4.1"></a>Applicatives</h5>
<!--l. 332--><p class="noindent" >Applicative functors address an obvious limitation of functors: What if we
wanted to apply a function to multiple effectful results ? They were first
discussed by McBride and Patterson [...], although they were documented before
that. In Haskell&#8217;s notation applicative functors have the following type class
<div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++10x.png" alt="class (Functor f) &#x21D2;   Applicative f where

           pure   ::  a &#x2192;  f a
        (&#x003C; &#x22C6; &#x003E; )  ::  f (a &#x2192;  b) &#x2192; f a &#x2192;  f b
" class="math-display" ></center>
</div>Here <span 
class="cmmi-12">f </span>represent the container. The applicative functor adds the infix operation <span 
class="cmmi-12">&#x003C; &#x22C6; &#x003E;</span>
and operation <span 
class="cmmi-12">pure </span>to those of the functor.
<!--l. 344--><p class="noindent" ><span 
class="cmmi-12">pure </span>puts a value of type <span 
class="cmmi-12">a </span>into the container.
                                                                          

                                                                          
<!--l. 346--><p class="noindent" >There is a close relation ship between functors and applicative functors :
<div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++11x.png" alt="fmapf  x = puref &#x003C; * &#x003E; x
" class="math-display" ></center>
</div>Lifting a function <span 
class="cmmi-12">f </span>into an environment using <span 
class="cmmi-12">pure </span>and applying to a value in a
context is the same as using <span 
class="cmmi-12">fmap </span>to apply <span 
class="cmmi-12">f </span>directly.
<!--l. 356--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">2.4.2   </span> <a 
 id="x1-120002.4.2"></a>Brackets</h5>
<!--l. 361--><p class="noindent" >In their paper [....] McBride and Paterson introduce a convenient &#8217;bracket&#8217; notation to
capture the application of a pure function <span 
class="cmmi-12">f </span>to a sequence of sub computations :
<div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++12x.png" alt="&#x27E6;f L1...Ln&#x27E7; = f &#x003C;  * &#x003E; L1 &#x003C; * &#x003E;  ...&#x003C; * &#x003E;  Ln
" class="math-display" ></center>
</div><span 
class="cmmi-12">pure </span>lifts the pure function <span 
class="cmmi-12">f </span>into the applicative functor, which is then applied to the
containers in the remainder of the bracket. Note that the structure of the
computation remains fixed. This makes brackets easier to use than using
applicatives directly. The essence of the bracket notion is captured in listing
<a 
href="#x1-19001r4">4<!--tex4ht:ref: bracket --></a>
<!--l. 374--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.5   </span> <a 
 id="x1-130002.5"></a>Monads</h4>
<!--l. 381--><p class="noindent" >The monad type class has the following declaration in Haskell : <div class="eqnarray">
                                                                          

                                                                          
<center class="math-display" >
<img 
src="func-idioms-c++13x.png" alt="class Monad  m  where

              return  :: a &#x2192;  m a
             (&#x003E; &#x003E;= )  :: m a &#x2192;  (a &#x2192;  m b) &#x2192; m  b[...]
" class="math-display" ></center>
</div>
<!--l. 389--><p class="noindent" >Functors an applicative functors apply pure functions to values in containers. Pure
functions have their place. They are easily combined and heir results are easily verified.
However pure functions don&#8217;t capture all the complexity of a program. For example
the computation defined in the body of the function may fail. We may want to
combine functions like that as part of a multi step computation. In the case of failure
in one of the steps the remainder of the computation should be discarded. An other
example is IO. The return type of these functions is the IO channel, so these functions
cannot be pure. We may want to combine functions which write data to an IO
channel.
<!--l. 400--><p class="noindent" >Yet we do want to combine functions like that in a meaningful way.
<!--l. 403--><p class="noindent" >Monads need to satisfy certain laws, the justification of which can be found in
category theory.
<!--l. 405--><p class="noindent" >[TBD]...
<!--l. 411--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-140003"></a>The Functional Idioms in C++</h3>
<!--l. 417--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-150003.1"></a>General Approach</h4>
<!--l. 420--><p class="noindent" >I try to provide a sketch on how to implement the functional idioms discussed in
section&#x00A0;<a 
href="#x1-60002">2<!--tex4ht:ref: sec:funcidioms --></a>. The implemenations require that some of the C++11 standards are
supported by the compiler, notably variadic templates and lambda&#8217;s. The approach is
to provide a definition in the form of a templated struct. Typically this struct will have
                                                                          

                                                                          
curried and n uncurried version. I use stl&#8217;s <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">function </span>template to highlight the
interface and return type. However, the speciliazation may in fact be written to
support lambda&#8217;s because lambda&#8217;s are no automatically converted to <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">function</span>.
In some cases the return type can be cumbersome to explicitly state and <span 
class="cmmi-12">auto </span>is used
instead.
<!--l. 430--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-160003.2"></a>Functor</h4>
<div class="minipage"><!--l. 434-->
<a 
 id="x1-16001r2"></a>
<a 
 id="x1-16002"></a><div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-16003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">class</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16012r10"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;2:
    </span><span  
class="content">functor
    in
    C++</span></div><!--tex4ht:label?: x1-16001r3 -->
</div>
</div> Listing <a 
href="#x1-16001r2">2<!--tex4ht:ref: c++functor --></a> shows a template which defines the functor <span 
class="cmmi-12">fmap </span>from type <span 
class="cmmi-12">A </span>to type <span 
class="cmmi-12">B</span>
for a type class <span 
class="cmmi-12">F</span>. The class F can have more than one template parameter, as
indicated by the variadic template. This allows specialization for containers since they
have more than one template parameter.
<!--l. 457--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-170003.3"></a>Applicative Functor and Brackets</h4>
<!--l. 462--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">3.3.1   </span> <a 
 id="x1-180003.3.1"></a>Applicative</h5>
<!--l. 466--><p class="noindent" >In C++ we don&#8217;t have the same leeway in constructing functions names
and fixity as we do in Haskell. I&#8217;ll call <span 
class="cmr-12">(</span><span 
class="cmmi-12">&#x003C; &#x22C6; &#x003E;</span><span 
class="cmr-12">) </span><span 
class="cmmi-12">apply </span>and use it in prefix
mode.
<!--l. 469--><p class="noindent" >The <span 
class="cmmi-12">apply </span>or <span 
class="cmmi-12">&#x003C; &#x22C6; &#x003E; </span>operation of the applicative functor looks similar to <span 
class="cmmi-12">fmap</span>, except
that the function <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">b </span>is inside the &#8217;container&#8217; f.
                                                                          

                                                                          
<div class="minipage"><!--l. 476-->
<a 
 id="x1-18001r3"></a>
<a 
 id="x1-18002"></a><div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-18003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">class</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18005r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18012r10"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;3:
    </span><span  
class="content">applicative
    functor
    template
    in
    C++</span></div><!--tex4ht:label?: x1-18001r3 -->
</div></div>
<!--l. 493--><p class="noindent" ><a 
href="#x1-18001r3">3<!--tex4ht:ref: apf_temp --></a> shows the applicative functor as a template in C++. Each individual container needs
to provide its own implementation.
<!--l. 502--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">3.3.2   </span> <a 
 id="x1-190003.3.2"></a>Bracket</h5>
<!--l. 507--><p class="noindent" >A bracket is a convenience function which applies an <span 
class="cmmi-12">n </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">ary </span>pure function to <span 
class="cmmi-12">n</span>
containers using applicative functors.
<!--l. 513-->
<a 
 id="x1-19001r4"></a>
<a 
 id="x1-19002"></a>
<div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-19003r1"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Tx</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">class</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19004r2"></a></span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19005r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">curry</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">_helper</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">sizeof</span><span 
class="cmss-8x-x-75">...(</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">...)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19008r6"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19009r7"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19010r8"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Tx</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">class</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19011r9"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">_helper</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">2,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L2</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L2</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ret</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">_helper</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">1,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L2</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Cont</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">APF</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">J</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">APF</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ret</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L2</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">J</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19026r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19027r25"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19028r26"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;4:
    </span><span  
class="content">applicative
    brackets
    in
    c++</span></div><!--tex4ht:label?: x1-19001r3 -->
</div>
<!--l. 548--><p class="noindent" >Listing <a 
href="#x1-19001r4">4<!--tex4ht:ref: bracket --></a> shows the function <span 
class="cmmi-12">bracket </span>implemented using the <span 
class="cmmi-12">bracket</span><sub><span 
class="cmmi-8">h</span></sub><span 
class="cmmi-12">elper </span>struct.
The template of <span 
class="cmmi-12">bracket </span>has several classes. The first class is the type of the
container. The second type is the type of the function or functor object. A variadic
template is used to refer to the remaining types of the container instances. The
<span 
class="cmmi-12">sizeof... </span>operator is used to determine the number of container instances passed
in.
<!--l. 555--><p class="noindent" >First we convert n-ary the function <span 
class="cmmi-12">f </span>by currying it : <span 
class="cmmi-12">f </span><span 
class="cmr-12">:: (</span><span 
class="cmmi-12">x,y,z</span><span 
class="cmr-12">) </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">k </span><span 
class="cmsy-10x-x-120">&#x21D2; </span><span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">c</span></sub> <span 
class="cmr-12">:: </span><span 
class="cmmi-12">x </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">y </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">z </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">k</span>.
<span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">c</span></sub> is lifted into the container using pure pure <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">c</span></sub> <span 
class="cmr-12">= </span><span 
class="cmmi-12">Lx </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">y </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">z </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">k</span>. This is then
applied to the first container <span 
class="cmmi-12">L</span><sub><span 
class="cmr-8">1</span></sub> and results in a lifted partially applied function
                                                                          

                                                                          
<span 
class="cmmi-12">Ly </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">z </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">k</span>. That is we have taken the function <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">c</span></sub> and applied it to the value in the
first container. The result is a container of a function with a cardinality one less then
<span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">c</span></sub>.
<!--l. 561--><p class="noindent" >We keep doing this until a result is returned. The implementation below applies the
curried function recursively to a the containers. The bottom of the recursion is
reached when the last container is processed.
<!--l. 565--><p class="noindent" >The value of the <span 
class="cmmi-12">sizeof... </span>operator, i.e. the number of container instances passed in
determines which specialization of <span 
class="cmmi-12">bracket</span><sub><span 
class="cmmi-8">h</span></sub><span 
class="cmmi-12">elper </span>to call.
<!--l. 572--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-200003.4"></a>Monad</h4>
<div class="minipage"><!--l. 578-->
<a 
 id="x1-20001r5"></a>
<a 
 id="x1-20002"></a><div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-20003r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20004r2"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">class</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20005r3"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20006r4"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">mreturn</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20014r12"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;5:
    </span><span  
class="content">monad
    defintion
    in
    C++</span></div><!--tex4ht:label?: x1-20001r3 -->
</div></div>
<!--l. 598--><p class="noindent" >Monads extend applicative functors and that&#8217;s reflected in the definition shown
in listing <a 
href="#x1-20001r5">5<!--tex4ht:ref: cppmonad --></a>. I&#8217;ve used <span 
class="cmmi-12">mreturn </span>for <span 
class="cmmi-12">return </span>and <span 
class="cmmi-12">bind </span>for <span 
class="cmmi-12">&#x003E;&#x003E;</span><span 
class="cmr-12">=</span>. <span 
class="cmmi-12">mreturn</span>
is identical to the <span 
class="cmmi-12">pure </span>function for applicative functors. I use a variadic
template to allow monad to be specialized for stl containers which have multiple
template arguments. The bind method in <a 
href="#x1-20001r5">5<!--tex4ht:ref: cppmonad --></a> is curried : It takes a monad of
type <span 
class="cmmi-12">A </span>and return a function. This function takes an argument of type <span 
class="cmmi-12">A</span>
and returns a monad of type <span 
class="cmmi-12">B</span>, just like haskell&#8217;s monad definition shown
above.
<!--l. 608--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-210004"></a>Maybe</h3>
<!--l. 613--><p class="noindent" >
                                                                          

                                                                          
<h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-220004.1"></a>Motivation</h4>
<!--l. 618--><p class="noindent" >A simple way to capture failure without throwing an exception is to have the function
return a value and a boolean as part of a tuple. If the boolean is true, the
computation succeeded and the vlaue is valid. Otherwise, an exception has occured.
Function composition would also not be so obvious. The first function in the
chain would have a simple type as an argument, bout it would return a tuple.
The second function in the chain would now need to accept this tuple as an
argument.
<!--l. 623--><p class="noindent" >Another drawback is that This is not a type safe approach. The type of this tuple
would be a data type and a boolean. Nothing would indicate that this is a special
tuple, signifying a failed computation.
<!--l. 626--><p class="noindent" >Haskell introduces the <span 
class="cmmi-12">Maybe </span>type class to handle this. The Maybe type class has two
constructors or values : <div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++14x.png" alt="Maybe a   =  None |Justa
" class="math-display" ></center>
</div>Here <span 
class="cmmi-12">a </span>is the data type whose value we compute. A successful computation returns
<span 
class="cmmi-12">Justa </span>and a failed computation return <span 
class="cmmi-12">None</span>. Such computataions would have the
following function signature : <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192;</span> Maybe <span 
class="cmmi-12">b</span>.
<!--l. 638--><p class="noindent" >The functor would apply the function to the value &#8217;inside&#8217; <span 
class="cmmi-12">Just</span>, or return <span 
class="cmmi-12">None </span>if the
input was <span 
class="cmmi-12">None</span>. The Monad allows you to combine functions which return a <span 
class="cmmi-12">Maybe</span>
type.
<!--l. 642--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-230004.2"></a>Maybe Template Class</h4>
<!--l. 646--><p class="noindent" >The Maybe template class (or struct) in listing <a 
href="#x1-23001r6">6<!--tex4ht:ref: maybe --></a> is an attempt to capture the spirit of
Haskell&#8217;s <span 
class="cmmi-12">Maybe </span>type class. The Maybe class is in fact a wrapper around a
<span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">pair &#x003C; A,bool &#x003E;</span>, where A is the template class. If the boolean member of
this pair is false, the Maybe represent a failed computation. Otherwise it
represents a successful one and the dereference operator <span 
class="cmmi-12">&#x22C6; </span>can be used to get the
value.
                                                                          

                                                                          
<!--l. 651--><p class="noindent" >The Maybe class has two constructors. The default constructor creates a &#8217;failed&#8217; state.
The other constructor takes a value of type A and instanciates a successful
computation.
<!--l. 654--><p class="noindent" >The constuctors are private and the caller has to use the <span 
class="cmmi-12">Just </span>or <span 
class="cmmi-12">None </span>factory
methods to instantiate the appropriate <span 
class="cmmi-12">Maybe </span>instance.
<!--l. 656--><p class="noindent" >The Maybe structure returned by <span 
class="cmmi-12">None</span><span 
class="cmr-12">() </span>as presented here is different from Haskell&#8217;s
<span 
class="cmmi-12">None</span>. In C++ this failure still has a type associated with it. It&#8217;s type is
<span 
class="cmmi-12">Maybe &#x003C; A &#x003E; </span>and it&#8217;s the internal state which indicates that the computation
failed.
<!--l. 660--><p class="noindent" >This means that we need to instantiate a different Maybe object in the Functor, even
if the input is a <span 
class="cmmi-12">amybe </span>representing a failed computation.
<!--l. 663--><p class="noindent" >However the comparison of two failed computations should succees, regardless of the
class type. This is done by overloading the comparison operator as shown in Listing <a 
href="#x1-23046r7">7<!--tex4ht:ref: maybeaux --></a>.
In contrast the comparison of two <span 
class="cmmi-12">Maybe </span>instances should fail if they represent a
successful computation but of different value types. The <span 
class="cmmi-12">eq </span>method is used to
determine equality if the type classes are the same.
<!--l. 668--><p class="noindent" >In addition to the comparison operator listing <a 
href="#x1-23046r7">7<!--tex4ht:ref: maybeaux --></a> shows convenience function <span 
class="cmmi-12">just </span>and
<span 
class="cmmi-12">none </span>to tersely instantiate <span 
class="cmmi-12">Maybe</span>&#8217;s. Use of these functions is shown in listing
<a 
href="#x1-23083r8">8<!--tex4ht:ref: maybeexample --></a>.
<div class="minipage"><!--l. 676-->
<a 
 id="x1-23001r6"></a>
<a 
 id="x1-23002"></a><div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-23003r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23004r2"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23005r3"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">_type</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">void</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">=(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">delete</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typeid</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">name</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">Just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">else</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23026r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23027r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23028r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23029r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23030r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23031r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">eq</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23032r30"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&amp;&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23033r31"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23034r32"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23035r33"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23036r34"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23037r35"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23038r36"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23039r37"></a></span><span 
class="cmssbx-10x-x-60">private</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23040r38"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23041r39"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">false</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23042r40"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">explicit</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">true</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23043r41"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pair</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23044r42"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23045r43"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;6:
    </span><span  
class="content">Implementation
    of
    the
    Maybe
    class</span></div><!--tex4ht:label?: x1-23001r4 -->
</div></div>
                                                                          

                                                                          
<div class="minipage"><!--l. 731-->
<a 
 id="x1-23046r7"></a>
<a 
 id="x1-23047"></a><div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-23048r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23049r2"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23050r3"></a></span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23051r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23052r5"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23053r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23054r7"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23055r8"></a></span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">none</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23056r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23057r10"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23058r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23059r12"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23060r13"></a></span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23061r14"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23062r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23063r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23064r17"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23065r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23066r19"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23067r20"></a></span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">==(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23068r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">eq</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&amp;&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">eq</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">true</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23069r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">false</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23070r23"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23071r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23072r25"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23073r26"></a></span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">==(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23074r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">eq</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23075r28"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23076r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23077r30"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23078r31"></a></span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">!=(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23079r32"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">!(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23080r33"></a></span><span 
class="cmsy-6">}</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;7:
    </span><span  
class="content">auxilliary
    function
    for
    the
    Maybe
    class</span></div><!--tex4ht:label?: x1-23046r4 -->
</div></div>
<div class="minipage"><!--l. 777-->
<a 
 id="x1-23083r8"></a>
<a 
 id="x1-23084"></a><div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-23085r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23086r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23087r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23088r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23089r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">none</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23090r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23091r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23092r8"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;8:
    </span><span  
class="content">Example
    of
    the
    use
    of
    Maybe</span></div><!--tex4ht:label?: x1-23083r4 -->
</div></div>
<!--l. 791--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-240004.3"></a>Functor</h4>
<!--l. 796--><p class="noindent" >The <span 
class="cmmi-12">Maybe </span>structure can be thought of as a value container. The functor method
<span 
class="cmmi-12">fmap </span>can be used to apply a pure function to the value contained in the <span 
class="cmmi-12">Maybe</span>
without explicitly pulling the value out of the conatiner. If the functor is applied to a
failed computation a failed computation is returned.
<!--l. 801--><p class="noindent" >Listing <a 
href="#x1-24001r9">9<!--tex4ht:ref: maybefunctor --></a> shows the specialization of the functor template introduced in section&#x00A0;<a 
href="#x1-90002.3">2.3<!--tex4ht:ref: subsec:functor --></a>.
The speciliazation shows both a curried and uncurried version of the <span 
class="cmmi-12">fmap</span>
method.
<!--l. 804--><p class="noindent" >The expression <span 
class="cmmi-12">decltype</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">A</span><span 
class="cmr-12">())) </span>is used to determine the return type, where <span 
class="cmmi-12">f </span>is the
function or lambda passed in and <span 
class="cmmi-12">A </span>is the type of the input parameter.
                                                                          

                                                                          
<div class="minipage"><!--l. 811-->
<a 
 id="x1-24001r9"></a>
<a 
 id="x1-24002"></a><div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-24003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">retval</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24025r23"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;9:
    </span><span  
class="content">Maybe
    Functor</span></div><!--tex4ht:label?: x1-24001r4 -->
</div></div>
<!--l. 842--><p class="noindent" >Listing <a 
href="#x1-23083r8">8<!--tex4ht:ref: maybeexample --></a> illustrates the use of the <span 
class="cmmi-12">Maybe </span>functor. The lambda <span 
class="cmmi-12">f </span>returns a
string.
<div class="minipage"><!--l. 848-->
<a 
 id="x1-24026r10"></a>
<a 
 id="x1-24027"></a><div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-24028r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24029r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24030r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">xxxxxx</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24031r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24032r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24033r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(10)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24034r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24035r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24036r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24037r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24038r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24039r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v3</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24040r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24041r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24042r15"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;10:
    </span><span  
class="content">example
    of
    the
    maybe
    functor</span></div><!--tex4ht:label?: x1-24026r4 -->
</div></div>
<!--l. 871--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a 
 id="x1-250004.4"></a>Applicative Functor</h4>
<div class="minipage"><!--l. 879-->
<a 
 id="x1-25001r11"></a>
<a 
 id="x1-25002"></a><div class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-25003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25005r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">retval</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">retval</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25022r20"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;11:
    </span><span  
class="content">Maybe
    applicative
    functor</span></div><!--tex4ht:label?: x1-25001r4 -->
</div>
</div> Listing&#x00A0;<a 
href="#x1-25001r11">11<!--tex4ht:ref: maybeapp --></a> shows the specialization of the applicative functor template for the <span 
class="cmmi-12">Maybe</span>
class. Instead of using <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">function </span>the specialization uses a more generic type
<span 
class="cmmi-12">lambda </span>for the function type. This allows the use of inline lambda&#8217;s, which otherwise
would not be possible. The <span 
class="cmmi-12">pure </span>method lifts a value into the <span 
class="cmmi-12">Maybe </span>context. In
                                                                          

                                                                          
subsection&#x00A0;<a 
href="#x1-110002.4.1">2.4.1<!--tex4ht:ref: subsubsec:applicatives --></a> I mentioned that there is a close relationship between te functor
and the applicative functor. This is used to implement the apply function.
<span 
class="cmmi-12">F </span>is the <span 
class="cmmi-12">Maybe </span>instance containing the lifted function. It is derefenced to
obtain the function for <span 
class="cmmi-12">fmap</span>. It would make sense to test the result of the
dereference. However it is not possible to instantiate an <span 
class="cmmi-12">Maybe </span>with an empty
lambda.
<!--l. 915--><p class="noindent" >The use of the applicative functor is illustrated in listing <a 
href="#x1-25023r12">12<!--tex4ht:ref: maybeappexample --></a>.
<div class="minipage"><!--l. 921-->
<a 
 id="x1-25023r12"></a>
<a 
 id="x1-25024"></a><div class="lstlisting" id="listing-12"><span class="label"><a 
 id="x1-25025r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25026r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pair</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25027r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25028r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(9,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25029r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25030r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmss-8x-x-75">_string</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25031r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25032r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25033r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25034r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmss-8x-x-75">_string</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25035r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25036r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lm</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25037r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25038r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25039r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25040r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25041r17"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;12:
    </span><span  
class="content">example
    of
    the
    maybe
    applicative</span></div><!--tex4ht:label?: x1-25023r4 -->
</div></div>
<!--l. 946--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a 
 id="x1-260004.5"></a>Monad</h4>
<!--l. 950--><p class="noindent" >Monads are used to combine functions which encapsulate exceptions in <span 
class="cmmi-12">Maybe </span>&#8217;s.
Listing <a 
href="#x1-26001r13">13<!--tex4ht:ref: maybemonad --></a> shows The specialization of the monad template from section&#x00A0;<a 
href="#x1-130002.5">2.5<!--tex4ht:ref: subsec:monad --></a> for the
<span 
class="cmmi-12">Maybe </span>class. The monad is derived from the applicative functor discuseed in the
previous section. The <span 
class="cmmi-12">mreturn </span>method uses it&#8217;s <span 
class="cmmi-12">pure </span>method to put a value into a
<span 
class="cmmi-12">Maybe </span>instance.
<!--l. 955--><p class="noindent" >The bind method has a <span 
class="cmmi-12">Maybe </span>instance and a function which returns a
<span 
class="cmmi-12">Maybe </span>as arguments. Unless the input is a failed computation and is equal
to <span 
class="cmmi-12">Maybe &#x003C; T &#x003E;</span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">None</span><span 
class="cmr-12">()</span>, the value contained in the <span 
class="cmmi-12">Maybe </span>instance is
passed on to the function. The result is another <span 
class="cmmi-12">Maybe </span>instance returned by
<span 
class="cmmi-12">bind</span>.
                                                                          

                                                                          
<div class="minipage"><!--l. 963-->
<a 
 id="x1-26001r13"></a>
<a 
 id="x1-26002"></a><div class="lstlisting" id="listing-13"><span class="label"><a 
 id="x1-26003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26005r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">mreturn</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26016r14"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">constructors</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">are</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">private</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">so</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">I</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">do</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">this</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">in</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">a</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">bit</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">of</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">a</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">rond</span><span 
class="cmsy-6">-</span><span 
class="cmssi-8x-x-75">about</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">way</span><span 
class="cmssi-8x-x-75">.</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">_type</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">_type</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">None</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26026r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26027r25"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;13:
    </span><span  
class="content">Maybe
    monad</span></div><!--tex4ht:label?: x1-26001r4 -->
</div></div>
<!--l. 996--><p class="noindent" >The use of the <span 
class="cmmi-12">Maybe </span>monad is illustrated in listing&#x00A0;<span 
class="cmssbx-10x-x-120">??</span>. The lambda called
<span 
class="cmmi-12">lambda </span>returns a <span 
class="cmmi-12">Maybe &#x003C; std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">string &#x003E; </span>with a string value in it when the
input is positive. Otherwise it returns a &#8217;None&#8217; instance of the <span 
class="cmmi-12">Maybe </span>class,
which represents some kind of failure. The monad binds the lambda and a
<span 
class="cmmi-12">Maybe &#x003C; int &#x003E; </span>instance which contains 56 as well as one which contains -89. In the
former case it results in a suucessful computation. In the latter case in a failed
one.
<!--l. 1003--><p class="noindent" >The listing also shows how the monad returned by bind is passed onto a second
monad which binds it to an in-line lambda function.
<div class="minipage"><!--l. 1008-->
<a 
 id="x1-26030r14"></a>
<a 
 id="x1-26031"></a><div class="lstlisting" id="listing-14"><span class="label"><a 
 id="x1-26032r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26033r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(56)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26034r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26035r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">good</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">!</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26036r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">none</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26037r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26038r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26039r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26040r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26041r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26042r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">-</span><span 
class="cmss-8x-x-75">89)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26043r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26044r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">-</span><span 
class="cmss-8x-x-75">89)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26045r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26046r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">===</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26047r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26048r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26049r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26050r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(89)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26051r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26052r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">===</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26053r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26054r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-26055r24"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;14:
    </span><span  
class="content">Maybe
    monad
    example</span></div><!--tex4ht:label?: x1-26030r4 -->
</div></div>
<!--l. 1041--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-270005"></a>Either</h3>
<!--l. 1047--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-280005.1"></a>Motivation</h4>
<!--l. 1052--><p class="noindent" >The Maybe type discussed in the previous section was used to handle exceptions ins a
type safe and functional way. One drawback was that it is not possible to pass on a
                                                                          

                                                                          
stack trace or othet information on the failure. If the computation fails no
additional information is passed back to the caller other than that the state is
<span 
class="cmmi-12">None</span>.
<!--l. 1056--><p class="noindent" >Haskell&#8217;s Either type class represents a computation which can return two values:
<div class="eqnarray">
<center class="math-display" >
<img 
src="func-idioms-c++15x.png" alt="Either a b = Left a |Right b
" class="math-display" ></center>
</div>
<!--l. 1061--><p class="noindent" >The Either type has two slots, with two different data types called <span 
class="cmmi-12">Left </span>and <span 
class="cmmi-12">Right</span>.
Data in in either of these two slots, but not both. So instead of using the <span 
class="cmmi-12">Maybe</span>
type instead the <span 
class="cmmi-12">Either </span>type can be used. The result of the computation
could be stored in the <span 
class="cmmi-12">Right </span>slot and exception information in the <span 
class="cmmi-12">Left</span>
slot.
<!--l. 1066--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-290005.2"></a>Either Type Class</h4>
<!--l. 1072--><p class="noindent" >The <span 
class="cmmi-12">Either </span>template class shown in <a 
href="#x1-29001r15">15<!--tex4ht:ref: either --></a> is a wrapper around a C++ tuple with three
types : <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">tuple &#x003C; L,R,bool &#x003E;</span>. The boolean in the last slot indicates which of the
other two slots is active. The implementation does require that the types <span 
class="cmmi-12">L </span>and <span 
class="cmmi-12">R</span>
have default constructors. As we &#8217;ll see this does preclude us from using C++
lambda&#8217;s for the applicative functor.
<!--l. 1077--><p class="noindent" >The constructors of the <span 
class="cmmi-12">Either </span>class are private and the <span 
class="cmmi-12">Left </span>or <span 
class="cmmi-12">Right </span>factory
methods must be used to create an <span 
class="cmmi-12">Either </span>instance. The assignment operator is
deleted. <span 
class="cmmi-12">Either </span>instances cannot be reasigned and it makes them somewhat
immutable.
<!--l. 1081--><p class="noindent" >The <span 
class="cmmi-12">Left</span><span 
class="cmr-12">() </span>and <span 
class="cmmi-12">Right</span><span 
class="cmr-12">() </span>methods are used to determine which &#8217;slot&#8217; is set. The (lower
case) <span 
class="cmmi-12">left</span><span 
class="cmr-12">() </span>and <span 
class="cmmi-12">right</span><span 
class="cmr-12">() </span>return the value in the slot. These functions are
unsafe, in the sense that the caller would need to test wich slot the active one
is before calling these. The auxilliary functions <span 
class="cmmi-12">Left</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">..</span><span 
class="cmr-12">) </span>and <span 
class="cmmi-12">Right</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">...</span><span 
class="cmr-12">) </span>in
listing&#x00A0;<a 
href="#x1-29071r16">16<!--tex4ht:ref: eitheraux --></a> are safer versions of the these methods. They return a <span 
class="cmmi-12">Maybe</span>
                                                                          

                                                                          
instance.
<div class="minipage"><!--l. 1090-->
<a 
 id="x1-29001r15"></a>
<a 
 id="x1-29002"></a><div class="lstlisting" id="listing-15"><span class="label"><a 
 id="x1-29003r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29004r2"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29005r3"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">left</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmss-8x-x-75">_type</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmss-8x-x-75">_type</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">void</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">=(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&amp;)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">delete</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">true</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29026r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29027r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(!</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29028r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29029r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29030r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29031r29"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">return</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">value</span><span 
class="cmssi-8x-x-75">.</span><span 
class="cmssi-8x-x-75">first</span><span 
class="cmssi-8x-x-75">.</span><span 
class="cmssi-8x-x-75">first</span><span 
class="cmssi-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29032r30"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">0</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29033r31"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29034r32"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29035r33"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29036r34"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">return</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">value</span><span 
class="cmssi-8x-x-75">.</span><span 
class="cmssi-8x-x-75">first</span><span 
class="cmssi-8x-x-75">.</span><span 
class="cmssi-8x-x-75">second</span><span 
class="cmssi-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29037r35"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">1</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29038r36"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29039r37"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29040r38"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29041r39"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typeid</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">name</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typeid</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">name</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29042r40"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29043r41"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">null</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29044r42"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29045r43"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">else</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29046r44"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">null</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29047r45"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29048r46"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29049r47"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29050r48"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29051r49"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">eq</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29052r50"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">eqval</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmssbx-10x-x-60">this</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29053r51"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">0</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">0</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29054r52"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">1</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">1</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">r</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29055r53"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29056r54"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">((</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29057r55"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&amp;&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">eqval</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29058r56"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29059r57"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29060r58"></a></span><span 
class="cmssbx-10x-x-60">private</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29061r59"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">left</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">true</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29062r60"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">false</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29063r61"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29064r62"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29065r63"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29066r64"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29067r65"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29068r66"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;15:
    </span><span  
class="content">Either
    type
    class</span></div><!--tex4ht:label?: x1-29001r5 -->
</div></div>
<div class="minipage"><!--l. 1169-->
<a 
 id="x1-29071r16"></a>
<a 
 id="x1-29072"></a><div class="lstlisting" id="listing-16"><span class="label"><a 
 id="x1-29073r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29074r2"></a></span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">E</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29075r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29076r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">E</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29077r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29078r6"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29079r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29080r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29081r9"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29082r10"></a></span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29083r11"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29084r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29085r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29086r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29087r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">none</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29088r16"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29089r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29090r18"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29091r19"></a></span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29092r20"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29093r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29094r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29095r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29096r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">none</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29097r25"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29098r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29099r27"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29100r28"></a></span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">==(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29101r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">false</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29102r30"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29103r31"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29104r32"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29105r33"></a></span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">==(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29106r34"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">eq</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29107r35"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29108r36"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29109r37"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29110r38"></a></span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">!=(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">D</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29111r39"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">!(</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29112r40"></a></span><span 
class="cmsy-6">}</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;16:
    </span><span  
class="content">Auxilliary
    functions
    for
    the
    Either
    type
    class</span></div><!--tex4ht:label?: x1-29071r5 -->
</div></div>
<!--l. 1218--><p class="noindent" >Listing <a 
href="#x1-29115r17">17<!--tex4ht:ref: eitherexamp --></a> shows a simpel example of the use of the <span 
class="cmmi-12">Either </span>class.
<div class="minipage"><!--l. 1223-->
<a 
 id="x1-29115r17"></a>
<a 
 id="x1-29116"></a><div class="lstlisting" id="listing-17"><span class="label"><a 
 id="x1-29117r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29118r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29119r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29120r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29121r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29122r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29123r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29124r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29125r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29126r10"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;17:
    </span><span  
class="content">Example
    of
    the
    use
    of
    Either</span></div><!--tex4ht:label?: x1-29115r5 -->
</div></div>
<!--l. 1241--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-300005.3"></a>Functor</h4>
                                                                          

                                                                          
<!--l. 1245--><p class="noindent" >The curried and uncurried version of the <span 
class="cmmi-12">Functor </span>template speciliaztion for the
<span 
class="cmmi-12">Either </span>is shown in listing <a 
href="#x1-30001r18">18<!--tex4ht:ref: eitherfunctor --></a>. The <span 
class="cmmi-12">Either </span>template class has tow type parameters:
One for its left and one for its right slot.
<!--l. 1248--><p class="noindent" >The body of <span 
class="cmmi-12">fmap </span>applies the function to the contents of the right slot of the
<span 
class="cmmi-12">Either </span>instance. If the left slot is used, <span 
class="cmmi-12">fmap </span>returns a new <span 
class="cmmi-12">Either </span>instance
with its left value set to the left value of the input. The type of the right
slot of the returned <span 
class="cmmi-12">Either </span>instance is determined by using <span 
class="cmmi-12">decltype</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">FA</span><span 
class="cmr-12">())</span>
where <span 
class="cmmi-12">f </span>is the input lambda and <span 
class="cmmi-12">A </span>the type of the right slot of the <span 
class="cmmi-12">Either</span>
instance.
<!--l. 1253--><p class="noindent" >The returm type of <span 
class="cmmi-12">fmap </span>is declared <span 
class="cmmi-12">auto </span>and is specified after the input parameter
list, since it refers back to input parameter <span 
class="cmmi-12">f</span>. The implementatioon of <span 
class="cmmi-12">fmap </span>for
<span 
class="cmmi-12">Maybe </span>and <span 
class="cmmi-12">Either </span>are very similar.
<div class="minipage"><!--l. 1259-->
<a 
 id="x1-30001r18"></a>
<a 
 id="x1-30002"></a><div class="lstlisting" id="listing-18"><span class="label"><a 
 id="x1-30003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30006r4"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">curried</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">version</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30014r12"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">uncurried</span><span 
class="cmssi-8x-x-75">,</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">for</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">functions</span><span 
class="cmssi-8x-x-75">..</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30023r21"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;18:
    </span><span  
class="content">Either
    Functor</span></div><!--tex4ht:label?: x1-30001r5 -->
</div></div>
<!--l. 1287--><p class="noindent" >Listing&#x00A0;<a 
href="#x1-30024r19">19<!--tex4ht:ref: eitherfunctorexamp --></a> shows an example of the use of the functor. The lambda adds <span 
class="cmr-12">2 </span>to the
input and is mapped over two different instances of <span 
class="cmmi-12">Either</span>. In the first instance the
right slot contains the value <span 
class="cmr-12">45</span>. <span 
class="cmmi-12">Fmap </span>returns <span 
class="cmmi-12">Either </span><span 
class="cmr-12">47</span>. The second instance
contains a string. Here <span 
class="cmmi-12">fmap </span>returns a instance with this string in its left
slot.
<!--l. 1294--><p class="noindent" >Note that <span 
class="cmmi-12">fmap </span>can&#8217;t change the active slot of the <span 
class="cmmi-12">Either </span>value it is applied to. The
input function to <span 
class="cmmi-12">fmap </span>is a pure function and it evaluates without side effects
captured in an <span 
class="cmmi-12">Either </span>instance.
<div class="minipage"><!--l. 1300-->
<a 
 id="x1-30024r19"></a>
<a 
 id="x1-30025"></a><div class="lstlisting" id="listing-19"><span class="label"><a 
 id="x1-30026r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30027r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(45)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30028r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30029r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30030r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">2+</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30031r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30032r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30033r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">l</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v2</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30034r9"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;19:
    </span><span  
class="content">Example
    of
    the
    Either
    functor</span></div><!--tex4ht:label?: x1-30024r5 -->
</div>
                                                                          

                                                                          
</div>
<!--l. 1317--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-310005.4"></a>Applicative Functor</h4>
<!--l. 1321--><p class="noindent" >Listing&#x00A0;<a 
href="#x1-31001r20">20<!--tex4ht:ref: eitherapp --></a> shows the specialization of the applicative functor template.
<!--l. 1323--><p class="noindent" >Similar to the functor the applicative functor also works only on the right slot of the
<span 
class="cmmi-12">Eitehr </span>instance. The <span 
class="cmmi-12">pure </span>method puts a value into the right slot of an
<span 
class="cmmi-12">Either </span>instance. The <span 
class="cmmi-12">bind </span>method is implemeneted using <span 
class="cmmi-12">fmap</span>. The unsafe
<span 
class="cmmi-12">right </span>method is called on to get the input function to <span 
class="cmmi-12">fmap </span>from the right
slot.
<div class="minipage"><!--l. 1331-->
<a 
 id="x1-31001r20"></a>
<a 
 id="x1-31002"></a><div class="lstlisting" id="listing-20"><span class="label"><a 
 id="x1-31003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31005r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31024r22"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;20:
    </span><span  
class="content">Either
    applicative
    functor</span></div><!--tex4ht:label?: x1-31001r5 -->
</div></div>
<!--l. 1360--><p class="noindent" >The role of the applicative functor is to apply n-ary pure functions to values in a
<span 
class="cmmi-12">conext </span>like <span 
class="cmmi-12">Either</span>. The <span 
class="cmmi-12">pure </span>method is used to &#8217;lift&#8217; the function into the container,
and bind is than use dto apply the function to values in the containers. This is
illustared in listing&#x00A0;<a 
href="#x1-31025r21">21<!--tex4ht:ref: eitherappexamp --></a> where the applicative functor is used to add two values
contained in the right slot of two different <span 
class="cmmi-12">Either </span>instances together using the
<span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">plus </span>C++ function object.
<!--l. 1365--><p class="noindent" >The first step is to curry <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">plus</span>, since the applicative functor works only with
unary function. The return type of <span 
class="cmmi-12">curry </span>is captured explicitly as a instance of
<span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">function</span>. The alternative would be to capture the return type using the <span 
class="cmmi-12">auto</span>
declaration, but in that case the type would in fact be that of a C++ lambda.
Since C++ lambda&#8217;s doen&#8217; have default constructors this would not work
with the fucntor and applicative functor specialization presented here. The
implementation of <span 
class="cmmi-12">Either </span>assumes that its template classes have default
constructors.
<!--l. 1371--><p class="noindent" >Next the curried function <span 
class="cmmi-12">cf </span>is lifted into the <span 
class="cmmi-12">Either </span>context using <span 
class="cmmi-12">pure</span>. The first
application of <span 
class="cmmi-12">bind </span>returns an <span 
class="cmmi-12">Either </span>instance with <span 
class="cmmi-12">cf </span>partially applied to <span 
class="cmr-12">23</span>. The
second application of bind returns an <span 
class="cmmi-12">Either </span>instance with <span 
class="cmr-12">68 </span>in its right
                                                                          

                                                                          
slot.
<div class="minipage"><!--l. 1379-->
<a 
 id="x1-31025r21"></a>
<a 
 id="x1-31026"></a><div class="lstlisting" id="listing-21"><span class="label"><a 
 id="x1-31027r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31028r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">plus</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31029r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31030r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">curry</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31031r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">23</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">+</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">45</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(23,45)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31032r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">23</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">+</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">45</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">(23)</span><span 
class="cmss-8x-x-75">(45)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31033r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31034r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">cf</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31035r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">V1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(23)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31036r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">V2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(45)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31037r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">V1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">V2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31038r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31039r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">V1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31040r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">V2</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31041r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31042r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31043r17"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;21:
    </span><span  
class="content">Either
    applicative</span></div><!--tex4ht:label?: x1-31025r5 -->
</div></div>
<!--l. 1404--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.5   </span> <a 
 id="x1-320005.5"></a>Monad</h4>
<div class="minipage"><!--l. 1416-->
<a 
 id="x1-32001r22"></a>
<a 
 id="x1-32002"></a><div class="lstlisting" id="listing-22"><span class="label"><a 
 id="x1-32003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32005r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">mreturn</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmss-8x-x-75">_type</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">left</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">right</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32025r23"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;22:
    </span><span  
class="content">Either
    monad</span></div><!--tex4ht:label?: x1-32001r5 -->
</div></div>
<div class="minipage"><!--l. 1451-->
<a 
 id="x1-32026r23"></a>
<a 
 id="x1-32027"></a><div class="lstlisting" id="listing-23"><span class="label"><a 
 id="x1-32028r1"></a></span>
<span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">eim</span><span 
class="cmss-8x-x-75">_2</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32029r2"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32030r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32031r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32032r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Left</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">smaller</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">than</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32033r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32034r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(1.15</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmsy-6">-</span><span 
class="cmss-8x-x-75">10)</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32035r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32036r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32037r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">repeat</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32038r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32039r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32040r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">repeat</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmsy-6">-</span><span 
class="cmss-8x-x-75">1,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32041r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32042r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">repeat</span><span 
class="cmss-8x-x-75">(12,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Either</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">Right</span><span 
class="cmss-8x-x-75">(45)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32043r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-32044r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0;</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;23:
     </span><span  
class="content">Example
     of
     the
     Either
     monad</span></div><!--tex4ht:label?: x1-32026r5 -->
</div></div>
<!--l. 1477--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-330006"></a>Lists and ZipLists</h3>
                                                                          

                                                                          
<!--l. 1481--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-340006.1"></a>Functor</h4>
<!--l. 1484--><p class="noindent" >For lists like <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">list </span>and <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">foward</span>_<span 
class="cmmi-12">list </span>fmap corresponds to map and is
equivalen to iteration over the elements in the list.
<!--l. 1489--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-350006.2"></a>Applicative Functor</h4>
<!--l. 1494--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">6.2.1   </span> <a 
 id="x1-360006.2.1"></a>List</h5>
<!--l. 1497--><p class="noindent" >For lists there a are two possible implementations for the applicative functor. In both
cases a list of functions is applied to a list of values, but in one case we apply each
function to every value and in te other we apply a function only if we have a value in
the corresponding position in the argument list. In the latter case we &#8217;zip&#8217; the list of
the functions and values.
<div class="minipage"><!--l. 1507-->
<a 
 id="x1-36001r24"></a>
<a 
 id="x1-36002"></a><div class="lstlisting" id="listing-24"><span class="label"><a 
 id="x1-36003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36004r2"></a></span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(1,</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36010r8"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">for</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">func</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">for</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">push</span><span 
class="cmss-8x-x-75">_front</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">func</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">reverse</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-36022r20"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;24:
    </span><span  
class="content">std::forward_list
    is
    an
    applicative
    functor</span></div><!--tex4ht:label?: x1-36001r6 -->
</div>
</div> The applicative functor for <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">forward</span>_<span 
class="cmmi-12">list </span>is shown in listing <a 
href="#x1-36001r24">24<!--tex4ht:ref: fwd_list_functor --></a>. The body of
apply consists of two nested loops traversing the input lists.
<h5 class="subsubsectionHead"><span class="titlemark">6.2.2   </span> <a 
 id="x1-370006.2.2"></a>ZipList</h5>
                                                                          

                                                                          
<div class="minipage"><!--l. 1546-->
<a 
 id="x1-37001r25"></a>
<a 
 id="x1-37002"></a><div class="lstlisting" id="listing-25"><span class="label"><a 
 id="x1-37003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">using</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37004r2"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37005r3"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37006r4"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">decltype</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37013r11"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">it1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">begin</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">it2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">begin</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">while</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">it1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">!=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">end</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&amp;&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">it2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">!=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">end</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">func</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">it1</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">it2</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">push</span><span 
class="cmss-8x-x-75">_front</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">func</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">it1</span><span 
class="cmss-8x-x-75">++;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">it2</span><span 
class="cmss-8x-x-75">++;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37026r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37027r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">reverse</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37028r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37029r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37030r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37031r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37032r30"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;25:
    </span><span  
class="content">ziplist
    is
    an
    applicative
    functor</span></div><!--tex4ht:label?: x1-37001r6 -->
</div></div>
<!--l. 1583--><p class="noindent" >In listing <a 
href="#x1-37001r25">25<!--tex4ht:ref: zip_list_functor --></a> I show the implementation of the applicative functor for the zip list based
on <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">list</span>. The implementation of the <span 
class="cmmi-12">functor </span>is a straight forward map and is
not shown. In the body of the <span 
class="cmmi-12">apply </span>method, the two lists are traversed
in parallel. The traversal stops when either one of the lists has run out of
elements.
<div class="minipage"><!--l. 1592-->
<a 
 id="x1-37033r26"></a>
<a 
 id="x1-37034"></a><div class="lstlisting" id="listing-26"><span class="label"><a 
 id="x1-37035r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37036r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">2,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">5,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">10</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37037r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37038r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lifted</span><span 
class="cmss-8x-x-75">_lambda</span><span 
class="cmss-8x-x-75">_1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37039r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lifted</span><span 
class="cmss-8x-x-75">_lambda</span><span 
class="cmss-8x-x-75">_1</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37040r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37041r7"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">prints</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">2,5,10</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37042r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37043r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lifted</span><span 
class="cmss-8x-x-75">_lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37044r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">zip</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lifted</span><span 
class="cmss-8x-x-75">_lambda</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37045r11"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">prints</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">2,</span>
<br />
       <div class="caption" 
><span class="id">Listing&#x00A0;26:
       </span><span  
class="content">the
       applicative
       functor
       for
       list
       and
       ziplist</span></div><!--tex4ht:label?: x1-37033r6 -->
</div></div>
<!--l. 1610--><p class="noindent" >Listing <a 
href="#x1-37033r26">26<!--tex4ht:ref: exampl_list --></a> shows a simple example of how the applicative functors for list and
zip list differ. A simple lambda function is lifted into a list and applied to a
list of integers. For the list case all the elements are printed. For the zip
list only one element is printed because the list of functions has only one
element.
<!--l. 1617--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.3   </span> <a 
 id="x1-380006.3"></a>Brackets</h4>
                                                                          

                                                                          
<div class="minipage"><!--l. 1625-->
<a 
 id="x1-38001r27"></a>
<a 
 id="x1-38002"></a><div class="lstlisting" id="listing-27"><span class="label"><a 
 id="x1-38003r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38004r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">char</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T3</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apf</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">m</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T3</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">goodbye</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f3</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L2</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L3</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cout</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[(1,</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(1,</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">goodbye</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(1,</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(1,</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">goodbye</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(2,</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(2,</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">goodbye</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(2,</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(2,</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">goodbye</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(3,</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(3,</span><span 
class="cmss-8x-x-75">y</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">goodbye</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(3,</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,(3,</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">goodbye</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,]</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;27:
     </span><span  
class="content">applicative
     functor
     for
     the
     std::forward_list
     using
     brackets</span></div><!--tex4ht:label?: x1-38001r6 -->
</div></div>
<!--l. 1643--><p class="noindent" >Listing <a 
href="#x1-38001r27">27<!--tex4ht:ref: br_fwd --></a> I show how brackets cane be used to apply a function to multiple
lists.
<div class="minipage"><!--l. 1649-->
<a 
 id="x1-38014r28"></a>
<a 
 id="x1-38015"></a><div class="lstlisting" id="listing-28"><span class="label"><a 
 id="x1-38016r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">using</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38017r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apf</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38018r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apf</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(1)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38019r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apf</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38020r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">T3</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apf</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">hello</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38021r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">T1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">T3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38022r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bracket</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f3</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L2</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">L3</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38023r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cout</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">std</span><span 
class="cmssi-8x-x-75">::</span><span 
class="cmssi-8x-x-75">shared</span><span 
class="cmssi-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssi-8x-x-75">St5tupleIIicSsEE</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmssi-8x-x-75">((1,</span><span 
class="cmssi-8x-x-75">a</span><span 
class="cmssi-8x-x-75">,</span><span 
class="cmssi-8x-x-75">hello</span><span 
class="cmssi-8x-x-75">)</span><span 
class="cmssi-8x-x-75">)</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;28:
     </span><span  
class="content">applicative
     functor
     for
     shared
     pointers
     applied
     using
     bracket
     notation</span></div><!--tex4ht:label?: x1-38014r6 -->
</div></div>
<!--l. 1664--><p class="noindent" >In listing <a 
href="#x1-38014r28">28<!--tex4ht:ref: br_ptr --></a> the data in three separate pointers is combined to create a pointer to a
tuple. Again notice that the function is pure in that it does not reference the container
the data was in.
<!--l. 1669--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.4   </span> <a 
 id="x1-390006.4"></a>Monad</h4>
                                                                          

                                                                          
<div class="minipage"><!--l. 1678-->
<a 
 id="x1-39001r29"></a>
<a 
 id="x1-39002"></a><div class="lstlisting" id="listing-29"><span class="label"><a 
 id="x1-39003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39004r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">map</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">for</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">insert</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">end</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">begin</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">end</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39017r15"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;29:
    </span><span  
class="content">monad
    for
    std::list</span></div><!--tex4ht:label?: x1-39001r6 -->
</div>
</div> The implementation for the stl <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">list </span>container is showm in listing <a 
href="#x1-39001r29">29<!--tex4ht:ref: listmonad --></a>. I&#8217;ve elided
the implementation of <span 
class="cmmi-12">mreturn</span>, which is passing its argument on to the applicative
functor&#8217;s pure method. Function <span 
class="cmmi-12">f </span>is mapped over list <span 
class="cmmi-12">M</span>. Since the return
type of <span 
class="cmmi-12">f </span>is a list the result is a list of lists. The this list is flattened, i.e. the
lists are merged into a single list <span 
class="cmmi-12">B </span>which is then returned. This flattening
operation is an essential part of the monad. It allows monadic operations to be
combined.
<!--l. 1708--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-400007"></a>Shared Pointers</h3>
<!--l. 1713--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-410007.1"></a>Shared pointers</h4>
<!--l. 1718--><p class="noindent" >A shared pointer is another example of a container which holds a value of a particular
type. The functor implementation for shared pointers is shown in list <a 
href="#x1-41001r30">30<!--tex4ht:ref: shpfunctor --></a>. <span 
class="cmmi-12">fmap</span>
returns a new shared pointer holding the result of the function application. We need to
return a new shared pointer because the input and return types of <span 
class="cmmi-12">f </span>may be different.
Also note that if the derefrence fails, an empty shared pointer is returned, rather than
an exception thrown.
                                                                          

                                                                          
<div class="minipage"><!--l. 1730-->
<a 
 id="x1-41001r30"></a>
<a 
 id="x1-41002"></a><div class="lstlisting" id="listing-30"><span class="label"><a 
 id="x1-41003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[=](</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_shared</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">nullptr</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[=](</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_shared</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">v</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">nullptr</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41024r22"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;30:
    </span><span  
class="content">shared
    pointer
    as
    container</span></div><!--tex4ht:label?: x1-41001r7 -->
</div></div>
<!--l. 1761--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-420007.2"></a>Functor</h4>
<!--l. 1765--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.3   </span> <a 
 id="x1-430007.3"></a>Applicative Functor</h4>
<!--l. 1770--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.4   </span> <a 
 id="x1-440007.4"></a>Monad</h4>
<div class="minipage"><!--l. 1777-->
<a 
 id="x1-44001r31"></a>
<a 
 id="x1-44002"></a><div class="lstlisting" id="listing-31"><span class="label"><a 
 id="x1-44003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44004r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmsy-6">*</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44014r12"></a></span><span 
class="cmss-8x-x-75">[..]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-44015r13"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;31:
    </span><span  
class="content">monad
    implemention
    for
    std::shared_ptr</span></div><!--tex4ht:label?: x1-44001r7 -->
</div></div>
<!--l. 1797--><p class="noindent" >In <a 
href="#x1-44001r31">31<!--tex4ht:ref: ptrmonad --></a> I show the monad implementation for <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">shared</span><sub><span 
class="cmmi-8">p</span></sub><span 
class="cmmi-12">tr</span>. The validity of the
shared pointer is checked before it is dereferenced and its value passed on to the
function <span 
class="cmmi-12">f</span>. If the shared pointer is empty (or invalid), an empty shared pointer of type
<span 
class="cmmi-12">B </span>is returned. This implies that a chain of monadic computations can return null if
any one of its individual computations fails.
                                                                          

                                                                          
<!--l. 1804--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-450008"></a>List of Shared Pointers</h3>
<!--l. 1810--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-460008.1"></a>Functor</h4>
<div class="minipage"><!--l. 1819-->
<a 
 id="x1-46001r32"></a>
<a 
 id="x1-46002"></a><div class="lstlisting" id="listing-32"><span class="label"><a 
 id="x1-46003r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">string</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-46004r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmsy-6">{</span><span 
class="cmssbx-10x-x-60">new</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">(10,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmsy-6">{</span><span 
class="cmssbx-10x-x-60">new</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">(20,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">b</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmsy-6">{</span><span 
class="cmssbx-10x-x-60">new</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">(3467,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">mnhjk</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">}}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-46005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmsy-6">\</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">([](</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-46006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-46007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0;</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;32:
     </span><span  
class="content">mapping
     over
     a
     list
     of
     shared
     pointers</span></div><!--tex4ht:label?: x1-46001r8 -->
</div></div>
<!--l. 1831--><p class="noindent" >A functor gives the ability to apply a pure function to a value in a container.
This decouples the values and the functions that operate on them from the
containers these values may be in. For example, consider a list of shared
pointers.
<!--l. 1835--><p class="noindent" >In listing <a 
href="#x1-46001r32">32<!--tex4ht:ref: ptrmap --></a> I define a function <span 
class="cmmi-12">show </span>which prints out the value of type <span 
class="cmmi-12">C</span>. I then
combine two functors, one for each container to apply <span 
class="cmmi-12">show </span>to each shared pointer in
the list. Lists of pointers are relatively standard in C++ programs. But functors can
also be defined for unary functions <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">b</span>.
<!--l. 1842--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-470008.2"></a>Applicative Functor</h4>
<!--l. 1847--><p class="noindent" >Applicative functors can be extended to combinations of containers like lists of shared
pointers. The code snippet in listing <a 
href="#x1-47001r33">33<!--tex4ht:ref: fmap_ptr_lst --></a> shows the functor implementation for a list of
shared pointers. <span 
class="cmmi-12">fmap </span>can be written as a straightforward combination of fmap for
the shared pointer and the list container. Listing <a 
href="#x1-47001r33">33<!--tex4ht:ref: fmap_ptr_lst --></a> shows a code snippet of the
applicative functor definition for a forward list of shared pointers. In this case we can&#8217;t
write the applicative as a combination of two applicative functors. The fcuntion in
the definition for the applicative functor for lists is not a reference. <span 
class="cmmi-12">apply</span>
encapsulates the access to the data stored in the shared pointer elements of the
                                                                          

                                                                          
list.
<div class="minipage"><!--l. 1861-->
<a 
 id="x1-47001r33"></a>
<a 
 id="x1-47002"></a><div class="lstlisting" id="listing-33"><span class="label"><a 
 id="x1-47003r1"></a></span>
<span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47004r2"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47012r10"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;33:
    </span><span  
class="content">fmap
    implementation
    for
    a
    list
    of
    shared
    pointers</span></div><!--tex4ht:label?: x1-47001r8 -->
</div></div>
<div class="minipage"><!--l. 1883-->
<a 
 id="x1-47013r34"></a>
<a 
 id="x1-47014"></a><div class="lstlisting" id="listing-34"><span class="label"><a 
 id="x1-47015r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">using</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47016r2"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47017r3"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47018r4"></a></span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47019r5"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47020r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47021r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47022r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47023r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47024r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">for</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">func</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47025r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">for</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47026r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">shared</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">lambda</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">func</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47027r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">push</span><span 
class="cmss-8x-x-75">_front</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47028r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47029r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47030r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">reverse</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47031r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">acc</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47032r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47033r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47034r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47035r21"></a></span><span 
class="cmsy-6">}</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;34:
    </span><span  
class="content">applicative
    functor
    for
    a
    list
    of
    shared
    pointers</span></div><!--tex4ht:label?: x1-47013r8 -->
</div></div>
<div class="minipage"><!--l. 1916-->
<a 
 id="x1-47036r35"></a>
<a 
 id="x1-47037"></a><div class="lstlisting" id="listing-35"><span class="label"><a 
 id="x1-47038r1"></a></span>
<span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_shared</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(5)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_shared</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(15)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_shared</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(25)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_shared</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(35)</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47039r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">c</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47040r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47041r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47042r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47043r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">lifted</span><span 
class="cmss-8x-x-75">_lambda</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47044r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">forward</span><span 
class="cmss-8x-x-75">_list</span><span 
class="cmss-8x-x-75">_of</span><span 
class="cmss-8x-x-75">_ptr</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">lifted</span><span 
class="cmss-8x-x-75">_lambda</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47045r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;35:
     </span><span  
class="content">example
     for
     list
     of
     pointers</span></div><!--tex4ht:label?: x1-47036r8 -->
</div></div>
<!--l. 1931--><p class="noindent" >In listing <a 
href="#x1-47036r35">35<!--tex4ht:ref: examp_list_ptr --></a> I show how a function can be mapped over a list of pointers, using its
functor and appplicative. The results are not too surprising.
                                                                          

                                                                          
<!--l. 1936--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.3   </span> <a 
 id="x1-480008.3"></a>Monad</h4>
<!--l. 1942--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-490009"></a>Unary Operations</h3>
<!--l. 1948--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">9.1   </span> <a 
 id="x1-500009.1"></a>Unary Operations and Curried Functions</h4>
<!--l. 1951--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">9.2   </span> <a 
 id="x1-510009.2"></a>Functor</h4>
<div class="minipage"><!--l. 1957-->
<a 
 id="x1-51001r36"></a>
<a 
 id="x1-51002"></a><div class="lstlisting" id="listing-36"><span class="label"><a 
 id="x1-51003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">unary</span><span 
class="cmss-8x-x-75">_op</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51004r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51005r3"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;36:
    </span><span  
class="content">unary
    operator</span></div><!--tex4ht:label?: x1-51001r9 -->
</div></div>
<!--l. 1967--><p class="noindent" >First I define the unary operator type in <a 
href="#x1-51001r36">36<!--tex4ht:ref: unop --></a>. A unary operator <span 
class="cmsy-10x-x-120">&#x2192; </span>constructs a unary
function :<span 
class="cmr-12">(</span><span 
class="cmsy-10x-x-120">&#x2192;</span><span 
class="cmr-12">)</span><span 
class="cmmi-12">r a </span><span 
class="cmr-12">=</span><span 
class="cmmi-12">&#x003E; </span><span 
class="cmr-12">(</span><span 
class="cmmi-12">r </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">a</span><span 
class="cmr-12">)</span>. Next I&#8217;ll provide an implementation for unary operators
in <a 
href="#x1-51006r37">37<!--tex4ht:ref: funop --></a>
<div class="minipage"><!--l. 1975-->
<a 
 id="x1-51006r37"></a>
<a 
 id="x1-51007"></a><div class="lstlisting" id="listing-37"><span class="label"><a 
 id="x1-51008r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51009r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">unary</span><span 
class="cmss-8x-x-75">_op</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51010r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51011r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51012r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51013r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">g</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51014r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">g</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51015r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">g</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51016r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51017r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51018r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51019r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51020r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51021r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">g</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51022r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">g</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">R</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">-</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51023r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">g</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51024r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51025r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51026r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51027r20"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;37:
    </span><span  
class="content">functor
    for
    unary
    operators</span></div><!--tex4ht:label?: x1-51006r9 -->
</div></div>
<!--l. 2002--><p class="noindent" >For a unary operator <span 
class="cmmi-12">f </span>in <span 
class="cmmi-12">fmap </span>would be <span 
class="cmr-12">(</span><span 
class="cmsy-10x-x-120">&#x2192;</span><span 
class="cmr-12">)</span><span 
class="cmmi-12">r </span>and fmap : <div class="eqnarray">
                                                                          

                                                                          
<center class="math-display" >
<img 
src="func-idioms-c++16x.png" alt="fmap  (a &#x2192;  b) &#x2192; (r &#x2192;  a) &#x2192; (r &#x2192;  b)
" class="math-display" ></center>
</div><span 
class="cmmi-12">fmap </span>takes a function <span 
class="cmr-12">(</span><span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">b</span><span 
class="cmr-12">) </span>and applies it <span 
class="cmmi-12">after </span>function <span 
class="cmr-12">(</span><span 
class="cmmi-12">r </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">a</span><span 
class="cmr-12">) </span>to yield a
function <span 
class="cmr-12">(</span><span 
class="cmmi-12">r </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">b</span><span 
class="cmr-12">)</span>. This corresponds to function composition.
<!--l. 2011--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">9.3   </span> <a 
 id="x1-520009.3"></a>Applicative Functor</h4>
<!--l. 2016--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">9.4   </span> <a 
 id="x1-530009.4"></a>Monad</h4>
<!--l. 2023--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-5400010"></a>Stateful Computations</h3>
<!--l. 2026--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.1   </span> <a 
 id="x1-5500010.1"></a>Capturing State</h4>
<!--l. 2031--><p class="noindent" >A change in state <span 
class="cmmi-12">s </span>is represented by a function <span 
class="cmmi-12">s </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmr-12">(</span><span 
class="cmmi-12">a,s</span><span 
class="cmr-12">)</span>. <span 
class="cmmi-12">a </span>is the value associated
with the state change. The state <span 
class="cmmi-12">s </span>is mutable.
<div class="minipage"><!--l. 2039-->
<a 
 id="x1-55001r38"></a>
<a 
 id="x1-55002"></a><div class="lstlisting" id="listing-38"><span class="label"><a 
 id="x1-55003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">explicit</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">set</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">false</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">set</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">true</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">set</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">set</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">set</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">else</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">(()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pair</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">set</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pair</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">true</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55026r24"></a></span><span 
class="cmssbx-10x-x-60">private</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55027r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pair</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55028r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">bool</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">set</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55029r27"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;38:
    </span><span  
class="content">state
    tuple</span></div><!--tex4ht:label?: x1-55001r10 -->
</div></div>
                                                                          

                                                                          
<!--l. 2073--><p class="noindent" >The state tuple in listing <a 
href="#x1-55001r38">38<!--tex4ht:ref: state_tuple --></a> is a thin wrapper around <span 
class="cmmi-12">std </span><span 
class="cmr-12">:: </span><span 
class="cmmi-12">pair </span>which adds a few
convenience methods. A state computation takes a state of type S and returns a state
tuple of types A and S.
<div class="minipage"><!--l. 2080-->
<a 
 id="x1-55030r39"></a>
<a 
 id="x1-55031"></a><div class="lstlisting" id="listing-39"><span class="label"><a 
 id="x1-55032r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55033r2"></a></span><span 
class="cmssbx-10x-x-60">using</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;39:
    </span><span  
class="content">state
    computation
    albel</span></div><!--tex4ht:label?: x1-55030r10 -->
</div>
</div> The state class shown in <a 
href="#x1-55034r40">40<!--tex4ht:ref: state --></a> encapsulates the state computation and adds a few
convenience methods.
<div class="minipage"><!--l. 2096-->
<a 
 id="x1-55034r40"></a>
<a 
 id="x1-55035"></a><div class="lstlisting" id="listing-40"><span class="label"><a 
 id="x1-55036r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55037r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55038r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55039r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">explicit</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55040r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55041r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55042r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(&amp;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">this</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55043r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">*</span><span 
class="cmssbx-10x-x-60">this</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55044r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55045r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55046r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">*</span><span 
class="cmssbx-10x-x-60">this</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55047r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55048r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55049r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typeid</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">name</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typeid</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">name</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55050r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55051r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55052r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55053r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">run</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55054r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55055r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55056r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55057r22"></a></span><span 
class="cmssbx-10x-x-60">private</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55058r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">C</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55059r24"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;40:
    </span><span  
class="content">state</span></div><!--tex4ht:label?: x1-55034r10 -->
</div></div>
<div class="minipage"><!--l. 2132-->
<a 
 id="x1-55060r41"></a>
<a 
 id="x1-55061"></a><div class="lstlisting" id="listing-41"><span class="label"><a 
 id="x1-55062r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55063r2"></a></span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55064r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55065r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">run</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55066r5"></a></span><span 
class="cmsy-6">}</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;41:
    </span><span  
class="content">runState</span></div><!--tex4ht:label?: x1-55060r10 -->
</div></div>
<!--l. 2147--><p class="noindent" >The <span 
class="cmmi-12">run</span><sub><span 
class="cmmi-8">s</span></sub><span 
class="cmmi-12">tate </span>method is key to the use of the state class and the function <span 
class="cmmi-12">runState</span>
executes this method by passing a state to it.
                                                                          

                                                                          
<div class="minipage"><!--l. 2154-->
<a 
 id="x1-55067r42"></a>
<a 
 id="x1-55068"></a><div class="lstlisting" id="listing-42"><span class="label"><a 
 id="x1-55069r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55070r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">default</span><span 
class="cmss-8x-x-75">_random</span><span 
class="cmss-8x-x-75">_engine</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55071r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">di</span><span 
class="cmss-8x-x-75">(10,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">20)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55072r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55073r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55074r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55075r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55076r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55077r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55078r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">10;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55079r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">di</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55080r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">iter</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55081r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">while</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmsy-6">-</span><span 
class="cmsy-6">-</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55082r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55083r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">iter</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55084r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55085r17"></a></span><span 
class="cmss-8x-x-75">[..]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;42:
    </span><span  
class="content">example
    of
    the
    use
    of
    the
    state
    class</span></div><!--tex4ht:label?: x1-55067r10 -->
</div></div>
<!--l. 2178--><p class="noindent" >The use of the state class is illustrated in listing <a 
href="#x1-55067r42">42<!--tex4ht:ref: stateexample --></a> using a random number generator.
A number is drawn from a uniform distribution of integers. <span 
class="cmmi-12">getrand </span>is the state
computation: It takes the current state of the uniform distribution and returns a
state tuple containing a random value as well as the new state. In the while
loop the state returned by the state computation is the used to generate the
next state. A monad can be used to glue subsequent state computations
together.
<!--l. 2185--><p class="noindent" >The state in listing <a 
href="#x1-55034r40">40<!--tex4ht:ref: state --></a> contains a value of type A as well as a state of type S. This
makes it a little different of the list or ptr containers which have a single type
constructor. We going to make the reasonable assumption that the type of the state is
not going to change between subsequent computations, although the type of the value
could. For example we could change the example above to have <span 
class="cmmi-12">getrand</span>
return a string in stead of an integer if the integer exceeds some threshold.
We are less likely to want to combine results by different random number
generators.
<!--l. 2194--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.2   </span> <a 
 id="x1-5600010.2"></a>Functor</h4>
                                                                          

                                                                          
<div class="minipage"><!--l. 2202-->
<a 
 id="x1-56001r43"></a>
<a 
 id="x1-56002"></a><div class="lstlisting" id="listing-43"><span class="label"><a 
 id="x1-56003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=[</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,&amp;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">next</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">next</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">next</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56020r18"></a></span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">//</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">this</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">doesn</span><span 
class="cmssi-8x-x-75">&#8217;</span><span 
class="cmssi-8x-x-75">t</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">work</span><span 
class="cmssi-8x-x-75">&#x00A0;</span><span 
class="cmssi-8x-x-75">(</span><span 
class="cmssi-8x-x-75">yet</span><span 
class="cmssi-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=[</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,&amp;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">next</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56026r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">next</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56027r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">next</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56028r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56029r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56030r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56031r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56032r30"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56033r31"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56034r32"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56035r33"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56036r34"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56037r35"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56038r36"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;43:
    </span><span  
class="content">State
    functor</span></div><!--tex4ht:label?: x1-56001r10 -->
</div></div>
<div class="minipage"><!--l. 2250-->
<a 
 id="x1-56039r44"></a>
<a 
 id="x1-56040"></a><div class="lstlisting" id="listing-44"><span class="label"><a 
 id="x1-56041r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56042r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">default</span><span 
class="cmss-8x-x-75">_random</span><span 
class="cmss-8x-x-75">_engine</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56043r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">di</span><span 
class="cmss-8x-x-75">(10,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">20)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56044r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56045r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56046r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56047r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56048r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56049r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56050r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56051r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">char</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">i</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56052r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">i</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">15)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56053r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56054r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56055r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">Z</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56056r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56057r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56058r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56059r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">10;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56060r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">while</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmsy-6">-</span><span 
class="cmsy-6">-</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56061r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">SRT</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56062r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">SRT</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">di</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56063r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56064r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56065r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56066r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">SRT</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56067r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">SRT</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">di</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56068r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56069r29"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;44:
    </span><span  
class="content">Example
    of
    the
    state
    functor</span></div><!--tex4ht:label?: x1-56039r10 -->
</div></div>
<!--l. 2288--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.3   </span> <a 
 id="x1-5700010.3"></a>Applicative Functor</h4>
<div class="minipage"><!--l. 2296-->
<div class="lstlisting" id="listing-45"><span class="label"><a 
 id="x1-57001r1"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57002r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57003r3"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57004r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57005r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57006r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=[</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57007r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57008r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57009r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57010r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57011r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57012r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57013r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57014r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57015r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57016r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=[</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,&amp;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57017r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">rs1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57018r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">resv</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">rs1</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57019r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">resv</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57020r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">resv</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57021r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">MT</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">fmap</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57022r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">rs2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">MT</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57023r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">rs2</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57024r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">rs2</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57025r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57026r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57027r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57028r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">new</span><span 
class="cmss-8x-x-75">_state</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57029r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57030r30"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57031r31"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57032r32"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57033r33"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57034r34"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57035r35"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57036r36"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
</div></div>
<div class="minipage"><!--l. 2344-->
<a 
 id="x1-57037r45"></a>
<a 
 id="x1-57038"></a>
<div class="lstlisting" id="listing-46"><span class="label"><a 
 id="x1-57039r1"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57040r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">istack</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">1,2,3,4</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57041r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57042r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">char</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">i</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57043r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">i</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">3)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57044r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57045r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57046r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">Z</span><span 
class="cmss-8x-x-75">&#8217;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57047r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57048r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57049r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">stack</span><span 
class="cmss-8x-x-75">_comp</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pop</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">istack</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57050r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">front</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57051r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">pop</span><span 
class="cmss-8x-x-75">_front</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57052r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">istack</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57053r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57054r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57055r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">istack</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">SM</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">pop</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57056r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57057r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">istack</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57058r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57059r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57060r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">SM</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57061r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57062r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">SC</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">apply</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">istack</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">char</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">SM</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57063r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">SC</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">L</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57064r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">r2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;45:
     </span><span  
class="content">Example
     of
     the
     state
     applicative
     functor</span></div><!--tex4ht:label?: x1-57037r10 -->
</div></div>
                                                                          

                                                                          
<!--l. 2383--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.4   </span> <a 
 id="x1-5800010.4"></a>Monad</h4>
<div class="minipage"><!--l. 2391-->
<a 
 id="x1-58001r46"></a>
<a 
 id="x1-58002"></a><div class="lstlisting" id="listing-47"><span class="label"><a 
 id="x1-58003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">public</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58004r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=[&amp;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,&amp;</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">M</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">newval</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">value</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">newval</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">comp</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">static</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">mreturn</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">applicative</span><span 
class="cmss-8x-x-75">_functor</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pure</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58019r17"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;46:
    </span><span  
class="content">state
    monad</span></div><!--tex4ht:label?: x1-58001r10 -->
</div></div>
<!--l. 2416--><p class="noindent" >The state monad in listing <a 
href="#x1-58001r46">46<!--tex4ht:ref: statemonad --></a> takes a function with an argument of type <span 
class="cmmi-12">A </span>and a
state with a value of type <span 
class="cmmi-12">A </span>and state of type <span 
class="cmmi-12">S </span>and returns a state of the same type
but with a value of type <span 
class="cmmi-12">B</span>. This state contains a computation constructed in the
body of the <span 
class="cmmi-12">bind </span>method. In the body of <span 
class="cmmi-12">comp </span>a new state is generated by calling
<span 
class="cmmi-12">runState </span>on <span 
class="cmmi-12">M</span>, which is the state passed into bind. The function <span 
class="cmmi-12">f </span>is then called on
the value generated by the state computation. The result is a new state which
is run with the new value. <span 
class="cmmi-12">comp </span>is returned as the new state in the <span 
class="cmmi-12">state</span>
constructor.
<div class="minipage"><!--l. 2429-->
<a 
 id="x1-58020r47"></a>
<a 
 id="x1-58021"></a><div class="lstlisting" id="listing-48"><span class="label"><a 
 id="x1-58022r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58023r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58024r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">default</span><span 
class="cmss-8x-x-75">_random</span><span 
class="cmss-8x-x-75">_engine</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58025r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58026r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58027r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58028r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58029r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58030r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58031r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58032r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58033r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58034r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58035r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58036r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58037r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58038r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58039r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58040r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S3</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S2</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58041r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S4</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S3</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58042r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S5</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S4</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58043r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S6</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S5</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58044r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S7</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S6</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58045r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S8</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S7</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58046r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Sf</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S8</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58047r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58048r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Sf</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(10,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">20)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58049r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58050r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Sf</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(100,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">200)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58051r30"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;47:
     </span><span  
class="content">example
     of
     the
     state
     monad</span></div><!--tex4ht:label?: x1-58020r10 -->
</div></div>
<!--l. 2468--><p class="noindent" >The state monad is used to string various stateful computations together. In listing <a 
href="#x1-58020r47">47<!--tex4ht:ref: examplestatemonad --></a>
I revisit the random number generator example discussed earlier. <span 
class="cmmi-12">getrand </span>is a
computation which gets an integer from the random number generator <span 
class="cmmi-12">s </span>passed into it
as an argument. <span 
class="cmmi-12">ST </span>is the initial state. The state monad is used to construct a state
which represents 10 calls to <span 
class="cmmi-12">getrand</span>. The function <span 
class="cmmi-12">f </span>prints the result of the random
number generator to stderr. Notice that when last state <span 
class="cmmi-12">Sf </span>is constructed
no random numbers have been generated yet. That is done by the call to
runState. First The resulting computation is called with a distribution engine with
a range between 10 and 20, and next with one with a range from 100 to
200.
                                                                          

                                                                          
<!--l. 2477--><p class="noindent" >The results of the random number generation in listing <a 
href="#x1-58020r47">47<!--tex4ht:ref: examplestatemonad --></a> are not available for further
processing. To collect the results we need to extend the state to include a list and
update the list with the result of the number generator.
<div class="minipage"><!--l. 2484-->
<a 
 id="x1-58054r48"></a>
<a 
 id="x1-58055"></a><div class="lstlisting" id="listing-49"><span class="label"><a 
 id="x1-58056r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58057r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">list</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">icont</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58058r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">uniform</span><span 
class="cmss-8x-x-75">_int</span><span 
class="cmss-8x-x-75">_distribution</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58059r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">pair</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">icont</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58060r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typedef</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58061r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58062r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">default</span><span 
class="cmss-8x-x-75">_random</span><span 
class="cmss-8x-x-75">_engine</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">((</span><span 
class="cmssbx-10x-x-60">unsigned</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">time</span><span 
class="cmss-8x-x-75">(0)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58063r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58064r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58065r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58066r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">push</span><span 
class="cmss-8x-x-75">_back</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58067r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58068r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58069r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58070r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_computation</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">getrand2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">t</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58071r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">t</span><span 
class="cmss-8x-x-75">]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58072r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">second</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">de</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58073r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_tuple</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">s</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">first</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">t</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58074r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58075r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58076r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58077r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">getrand</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58078r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58079r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[&amp;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">,&amp;</span><span 
class="cmss-8x-x-75">getrand2</span><span 
class="cmss-8x-x-75">](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58080r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58081r26"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">val</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">%</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">7</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58082r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">getrand2</span><span 
class="cmss-8x-x-75">(10000,11456)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58083r28"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58084r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58085r30"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58086r31"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58087r32"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S1</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">ST</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58088r33"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S2</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S1</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58089r34"></a></span><span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58090r35"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Sf</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">monad</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">bind</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">state</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">S12</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58091r36"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58092r37"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Sf</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">icont</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">(10,20)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58093r38"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58094r39"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runState</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">Sf</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">make</span><span 
class="cmss-8x-x-75">_pair</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">icont</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">idist</span><span 
class="cmss-8x-x-75">_t</span><span 
class="cmss-8x-x-75">(100,200)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58095r40"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">S</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-58096r41"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;48:
    </span><span  
class="content">extended
    state
    monad
    example</span></div><!--tex4ht:label?: x1-58054r10 -->
</div></div>
<!--l. 2533--><p class="noindent" >The valure in the state monad is not being used. In listing <a 
href="#x1-58054r48">48<!--tex4ht:ref: ext-statemonad-examp --></a> the state is extended to
include a list of value. In the state computation <span 
class="cmmi-12">getrand </span>the random value
is inserted into the list as well are returned as part of the state tuple. The
second computation <span 
class="cmmi-12">getrand</span><span 
class="cmr-12">2 </span>is a curried function whose firts argument is a
new range for the uniform distribution. It returns a state computation whihc
uses this new distribution range. The monadic function <span 
class="cmmi-12">f </span>noew returns a
different state, depending on whether the value passed in was a multiple of
7.
<!--l. 2545--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11   </span> <a 
 id="x1-5900011"></a>Futures and Future Values</h3>
<!--l. 2552--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">11.1   </span> <a 
 id="x1-6000011.1"></a>Futures and Async</h4>
<!--l. 2556--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">11.2   </span> <a 
 id="x1-6100011.2"></a>Capturing Future Values</h4>
                                                                          

                                                                          
<div class="minipage"><!--l. 2562-->
<a 
 id="x1-61001r49"></a>
<a 
 id="x1-61002"></a><div class="lstlisting" id="listing-50"><span class="label"><a 
 id="x1-61003r1"></a></span>
<span 
class="cmssbx-10x-x-60">template</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61004r2"></a></span><span 
class="cmssbx-10x-x-60">struct</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61005r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">explicit</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61006r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61007r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">=(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61008r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">if</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">==</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmssbx-10x-x-60">this</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">*</span><span 
class="cmssbx-10x-x-60">this</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61009r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">o</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61010r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">*</span><span 
class="cmssbx-10x-x-60">this</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61011r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61012r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61013r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61014r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typeid</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">name</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61015r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typeid</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">name</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61016r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61017r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61018r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61019r17"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61020r18"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">try</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61021r19"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">async</span><span 
class="cmss-8x-x-75">([=]</span><span 
class="cmsy-6">{</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">a</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61022r20"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">just</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">get</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61023r21"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">catch</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">exception</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61024r22"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">exception</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">e</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">what</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61025r23"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61026r24"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">none</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">()</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61027r25"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61028r26"></a></span><span 
class="cmssbx-10x-x-60">private</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">:</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61029r27"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">F</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61030r28"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61031r29"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61032r30"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61033r31"></a></span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">operator</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">ostream</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">const</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&amp;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fv</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61034r32"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61035r33"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fv</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">pp</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">strm</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61036r34"></a></span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61037r35"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61038r36"></a></span><span 
class="cmssbx-10x-x-60">template</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">typename</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61039r37"></a></span><span 
class="cmss-8x-x-75">Maybe</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runFutureValue</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">B</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fv</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">A</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61040r38"></a></span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61041r39"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fv</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">arg</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61042r40"></a></span><span 
class="cmsy-6">}</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;49:
    </span><span  
class="content">Future
    value
    type
    class</span></div><!--tex4ht:label?: x1-61001r11 -->
</div></div>
<div class="minipage"><!--l. 2614-->
<a 
 id="x1-61045r50"></a>
<a 
 id="x1-61046"></a><div class="lstlisting" id="listing-51"><span class="label"><a 
 id="x1-61047r1"></a></span>
<span 
class="cmss-8x-x-75">[...]</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61048r2"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">function</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">[](</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61049r3"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">start</span><span 
class="cmss-8x-x-75">...</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61050r4"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">5;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61051r5"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">while</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">n</span><span 
class="cmsy-6">-</span><span 
class="cmsy-6">-</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">{</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61052r6"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">this</span><span 
class="cmss-8x-x-75">_thread</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">sleep</span><span 
class="cmss-8x-x-75">_for</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">chrono</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">milliseconds</span><span 
class="cmss-8x-x-75">(1000)</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61053r7"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">.</span><span 
class="cmss-8x-x-75">&#8221;</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61054r8"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61055r9"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61056r10"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">x</span><span 
class="cmss-8x-x-75">+45;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61057r11"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmsy-6">}</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61058r12"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">future</span><span 
class="cmss-8x-x-75">_value</span><span 
class="cmmi-6">&#x003C;</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmssbx-10x-x-60">int</span><span 
class="cmmi-6">&#x003E;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fv</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">f</span><span 
class="cmss-8x-x-75">)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61059r13"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">fv</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61060r14"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">auto</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">=</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">runFutureValue</span><span 
class="cmss-8x-x-75">(</span><span 
class="cmss-8x-x-75">fv</span><span 
class="cmss-8x-x-75">,</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">45)</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61061r15"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">cerr</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">res</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmmi-6">&#x003C;&#x003C;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">std</span><span 
class="cmss-8x-x-75">::</span><span 
class="cmss-8x-x-75">endl</span><span 
class="cmss-8x-x-75">;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61062r16"></a></span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmssbx-10x-x-60">return</span><span 
class="cmss-8x-x-75">&#x00A0;</span><span 
class="cmss-8x-x-75">0;</span><span 
class="cmss-8x-x-75">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61063r17"></a></span><span 
class="cmss-8x-x-75">[...]</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;50:
    </span><span  
class="content">Example
    of
    the
    use
    of
    the
    future
    value
    type
    class</span></div><!--tex4ht:label?: x1-61045r11 -->
</div></div>
<!--l. 2638--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">11.3   </span> <a 
 id="x1-6200011.3"></a>Functor</h4>
<!--l. 2641--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">11.4   </span> <a 
 id="x1-6300011.4"></a>Applicative Functor</h4>
<!--l. 2644--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">11.5   </span> <a 
 id="x1-6400011.5"></a>Monad</h4>
                                                                          

                                                                          
<!--l. 2649--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">12   </span> <a 
 id="x1-6500012"></a>Discussion</h3>
<!--l. 2652--><p class="noindent" >The implemention of...
 
</body></html> 

                                                                          


